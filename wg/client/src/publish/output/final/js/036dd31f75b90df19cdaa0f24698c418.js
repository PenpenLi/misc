TIP_PREFIX="$",BS_UNKNOWN=0,BS_MSIE=1,BS_OPERA=2,BS_FIREFOX=3,BS_SAFARI=4,BS_CHROME=5,BS_NETSCAPE=6,BS_MOZILLA=7,BTN_LEFT=0,BTN_MID=1,BTN_RIGHT=2,G_ID_ASCCOMP=function(a,b){return a.id-b.id},G_ID_DESCCOMP=function(a,b){return b.id-a.id},tprofile=Class.extern(function(){this.init=function(){this.root=this._newNode(null),this.curNode=this.root,this.indent=0},this.begin=function(a){var b=(new Date).getTime();this.curNode.childNodes[a]||(this.curNode.childNodes[a]=this._newNode(this.curNode)),this.curNode.childNodes[a].lastTime=b,this.curNode.childNodes[a].count++,this.curNode=this.curNode.childNodes[a]},this.end=function(a){this.curNode=this.curNode.parentNode;var b=(new Date).getTime();this.curNode.childNodes[a].useTime=b-this.curNode.childNodes[a].lastTime,this.curNode==this.root&&(this.indent=0,this._printNodes(null,this.root))},this._printNodes=function(a,b){this.indent++,!a;for(var c in b.childNodes)this._printNodes(c,b.childNodes[c]);this.indent--},this._newNode=function(a){return{parentNode:a,lastTime:0,useTime:0,count:0,childNodes:{}}},this._getIndentWhiteSpace=function(){var a="";for(var b=0;b<this.indent;b++)a+="&nbsp;&nbsp;";return a}}).snew(),isNull=function(a){return a!=undefined&&a!=null?!1:!0},Math.clamp=function(a,b,c){return a<b?b:a>c?c:a},Math.randomInt=function(a){return Math.floor(Math.random()*1e8%a)},UnicodeStr=Class.extern(function(){var a=null;this.init=function(){a=this},this.byteSubStr=function(a,b){var d=0,e=function(a,c,e,f){return f+c>b?-1:(d=a,f+c)};return this.travel(a,e,c),a.substr(0,d+1)},this.gbkSubStr=function(a,c){var d=0,e=function(a,b,e,f){return f+b>c?-1:(d=a,f+b)};return this.travel(a,e,b),a.substr(0,d+1)},this.gbkLen=function(a){var c=function(a,b,c,d){return d+b};return this.travel(a,c,b)},this.travel=function(a,b,c){var d=0;for(var e=0;e<a.length;++e){var f=a.charCodeAt(e),g=c(f);d=b(e,g,f,d);if(d==-1)break}return d};var b=function(a){return a<=255?1:2},c=function(a){return a<=255?1:3}}).snew(),InputLimit=Class.extern(function(){var a;this.init=function(){a=this},this.isNeedLimitEvent=function(a){var b=TQ.getKeyCode(a);return b==VK_KEY.F5?!1:!a.ctrlKey||b!=VK_KEY.A&&b!=VK_KEY.C&&b!=VK_KEY.X&&b!=VK_KEY.Z&&b!=VK_KEY.Y?b>=VK_KEY.NUM_0||b==VK_KEY.RETURN||b==VK_KEY.SPACE?!0:!1:!1},this.maxGBKBytes=function(b,c,d){b._caller=d?d:NullCaller,TQ.addEvent(b,"keydown",function(d){d=d?d:window.event;if(!a.isNeedLimitEvent(d))return;UnicodeStr.gbkLen(b.value)>=c&&TQ.preventDefault(d),b._caller.invoke()}),TQ.addEvent(b,"keyup",function(a){UnicodeStr.gbkLen(b.value)>=c&&(b.value=UnicodeStr.gbkSubStr(b.value,c)),b._caller.invoke()})}}).snew(),ErrorGetter=Class.extern(function(){this.getCommErr=function(a){var b="";a.fileName&&(b+=a.fileName+":"),a.lineNumber&&(b+=a.lineNumber),a.name&&(b+=" ["+a.name+"] "),a.number&&(b+=" ["+a.number+"] "),a.errorNumber&&(b+=" ["+(a.errorNumber&65535)+"] "),a.message&&(b+=" ["+a.message+"]<br/>");var c=this.getStackList(a);c&&(b+="[stack]:<br/>");for(k in c)b+=c[k]+"<br/>";return b},this.getStackList=function(a){return a.stack?navigator.userAgent=="NODE"?a.stack.match(/[A-Za-z]:\\[^\)\s]*/g):a.stack.match(/http[^\)\s]*/g):null}}).snew(),EscapeString=Class.extern(function(){this.subStr=function(c,d){if(c.length<=d)return c.substr(0,c.length);var e=a(c,d);return b(e.s)?c.substr(0,e.pos):c.substr(0,d)};var a=function(a,b){var c=-1;for(var d=b-1,e=0;d>=0&&e<10;--d,++e){if(a.charAt(d)==";")return"";if(a.charAt(d)=="&"){c=d;break}}if(c<0)return"";var f=-1;for(var d=b,e=0;d<a.length&&e<10;++d,++e){if(a.charAt(d)=="&")return"";if(a.charAt(d)==";"){f=d;break}}return f<0?"":{pos:c,s:a.substr(c,f-c+1)}},b=function(a){var b=["&bfh;","&dkhl;","&dkhr;","&quot;","&apos;","&hcj;","&hck;","&hcl;"];for(var c in b)if(b[c]==a)return!0;return!1}}).snew(),TQ=new function(){var a,b=BS_UNKNOWN,c=0,d=["unknow","msie","opera","firefox","safari","chrome","netscape","mozilla"],e=null,f,g,h={},i=null,j=4,l=!1;this.initialize=function(){a=this,b=m();var c=navigator.userAgent.toLowerCase();l=!0,f=new Date},this.getUiBody=function(){return i||(i=TQ.getDomById("g_body")),i},this.isMobile=function(){return l},this.isEmptyDict=function(a){if(!a)return!0;for(var b in a)if(!isNull(a[b]))return!1;return!0},this.formatColorStr=function(a,b,c){return c?'<font color="'+b+'" style="'+c+'">'+a+"</font>":'<font color="'+b+'">'+a+"</font>"},this.getIe6DrtW=function(){return a.isIE6()?j:0},this.hasBit=function(a,b){return(a&b)==b},this.isIE6=function(){return this.isIE()&&this.getBrowserVer()<7},this.isIE7=function(){return this.isIE()&&this.getBrowserVer()>=7&&this.getBrowserVer()<8},this.isIE8=function(){return this.isIE()&&this.getBrowserVer()>=8&&this.getBrowserVer()<9},this.isIE9=function(){return this.isIE()&&this.getBrowserVer()>=9&&this.getBrowserVer()<10},this.isIE10=function(){return this.isIE()&&this.getBrowserVer()>=10&&this.getBrowserVer()<11},this.isIE=function(){return b==BS_MSIE},this.isLessVerIE=function(a){return this.isIE()&&this.getBrowserVer()<a},this.getDomParent=function(a){return a?a.parentNode:null},this.getBrowserVer=function(){return c},this.fixIE6Png=function(b){a.isIE6()&&(DD_belatedPNG.init(),DD_belatedPNG.fixPng(b))},this.getValidEvent=function(a){return a?a:window.event},this.formatLine=function(a){return'<div style="white-space:nowrap;">'+a+"</div>"},this.format=function(){return arguments.length==0?null:a.formatArgs(arguments[0],arguments,1)},this.formatArgs=function(a,b,c){var d=a;if(!b)return d;c||(c=0);for(var e=c;e<b.length;e++){var f=new RegExp("\\{"+(e-c)+"\\}","gm");d=d.replace(f,b[e])}return d},this.getFlashVer=function(){var a="";try{a=navigator.plugins["Shockwave Flash"].description}catch(b){try{a=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(b){}}return a},this.qfind=function(a,b,c){return Finder.qfind(a,b,c)},this.find=function(a,b,c,d){return Finder.find(a,b,c,d)},this.pairListToDict=function(a){var b={};for(var c=0,d=a.length/2;c<d;++c)b[a[2*c]]=a[2*c+1];return b},this.listToSet=function(a){var b={};for(var c=0;c<a.length;++c)b[a[c]]=!0;return b},this.dictToList=function(a){var b=[];for(var c in a)b.push(a[c]);return b},this.getLastFindIdx=function(){return Finder.getLastIdx()},this.getBrowserType=function(){return b},this.getBrowserName=function(){return d[b]},this.getScrollPos=function(){var a=document.body.scrollLeft?document.body.scrollLeft:0,b=document.body.scrollTop?document.body.scrollTop:0;return document.compatMode==="CSS1Compat"&&(a=document.documentElement.scrollLeft?document.documentElement.scrollLeft:a,b=document.documentElement.scrollTop?document.documentElement.scrollTop:b),{x:a,y:b}},this.getWinSize=function(){var a=n();return{cx:a.clientWidth,cy:a.clientHeight}},this.getWinInnerSize=function(){return this._getWinInnerSizeByQQApi()},this._getWinInnerSize=function(){if(window.innerWidth&&window.innerHeight)return{cx:window.innerWidth,cy:window.innerHeight};var a=document.getElementById("size_div"),b=document.body.clientWidth,c=document.body.clientHeight,d=a.clientWidth,e=a.clientHeight;if(this.isIE7()){var f=d<b;return{cx:d,cy:e+(f?this.getBrowserScollBarH():0)}}if(this.isIE()&&this.getBrowserVer()>7){var f=d<b,g=e<c;return{cx:d+(g?this.getBrowserScollBarW():0),cy:e+(f?this.getBrowserScollBarH():0)}}return{cx:d,cy:e}},this._getWinInnerSizeByQQApi=function(){var a=this._getWinInnerSize();return a},this.getBrowserScollBarH=function(){var a=document.getElementById("scrollbar_div");return 100-a.clientHeight},this.getBrowserScollBarW=function(){var a=document.getElementById("scrollbar_div");return 100-a.clientWidth},this.getAdjustPosByWinSize=function(a,b,c){c||(c={cx:0,cy:0});var d=this.getScrollPos(),e=this.getWinSize(),f={x:a.x,y:a.y};return f.x+b.cx+c.cx>d.x+e.cx?f.x=f.x-b.cx-c.cx/2:f.x+=c.cx,f.x<d.x&&(f.x=d.x),f.y+b.cy+c.cy>d.y+e.cy?f.y=f.y-b.cy-c.cy/2:f.y+=c.cy,f.y<d.y&&(f.y=d.y),f},this.createDom=function(a){return document.createElement(a)},this.getDomById=function(a){return document.getElementById(a)},this.appendClass=function(a,b){a.className||(a.className="");if(a.className.indexOf(b)>=0)return;a.className!==""&&(a.className+=" "),a.className+=b},this.removeClass=function(a,b){if(a.className){var c=/[\n\t]/g,d=/\s+/,e=b.toLowerCase().split(d),f=(" "+a.className.toLowerCase()+" ").replace(c," ");for(var g=0,h=e.length;g<h;++g)f=f.replace(new RegExp(" "+e[g]+" ","g")," ");a.className=this.trim(f)}},this.setClass=function(a,b){a.className=b},this.getClass=function(a){return a.className},this.getSubDom=function(a,b){var c=a;for(var d=0;d<b.length;++d)c=c.childNodes[b[d]];return c},this.hasSubDom=function(a,b){for(var c in a.childNodes)if(a.childNodes[c]==b)return!0;return!1},this.maxLength=function(b,c){var d=b.tagName.toLowerCase();d=="textarea"?(this.addEvent(b,"keydown",function(d){d=d?d:window.event;var e=a.getKeyCode(d);if(e==VK_KEY.F5)return;if(!(!d.ctrlKey||e!=VK_KEY.A&&e!=VK_KEY.C&&e!=VK_KEY.X&&e!=VK_KEY.Z&&e!=VK_KEY.Y))return;if(e>=VK_KEY.NUM_0||e==VK_KEY.RETURN||e==VK_KEY.SPACE){var f=b.value.length;f>=c&&a.preventDefault(d)}}),this.addEvent(b,"keyup",function(a){var d=b.value.length;d>=c&&(b.value=b.value.substring(0,c))})):d=="input"&&this.setAttr(b,"maxLength",c)},this.addEvent=function(a,c,d){a.addEventListener?(b==BS_FIREFOX&&c=="mousewheel"&&(c="DOMMouseScroll"),a.addEventListener(c,d,!1)):a.attachEvent?a.attachEvent("on"+c,d):a["on"+c]=d},this.removeEvent=function(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent?a.detachEvent("on"+b,c):a["on"+b]=null},this.removeElement=function(a,b){if(b>=0&&b<a.length){a[b]=null;for(var c=b;c<a.length-1;++c)a[c]=a[c+1];a.length-=1}},this.stopPropagation=function(a){a=a?a:window.event,a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation()},this.preventDefault=function(a){a=a?a:window.event,a.preventDefault?a.preventDefault():(a.returnValue=!1,a.cancelBubble=!0)},this.getKeyCode=function(a){a=a?a:window.event;var b=0;return a.keyCode?b=a.keyCode:a.which?b=a.which:b=a.charCode,b},this.mouseCoords=function(b){b=b?b:window.event;if(!isNull(b.pageX)||!isNull(b.pageY))return{x:b.pageX,y:b.pageY};var c=a.getScrollPos(),d=n();return{x:b.clientX+c.x-d.clientLeft,y:b.clientY+c.y-d.clientTop}},this.cloneEvent=function(a){var b={};return b.pageX=a.pageX,b.pageY=a.pageY,b.clientX=a.clientX,b.clientY=a.clientY,b.button=a.button,b},this.domOffset=function(a){var b=0,c=0,d=a;while(d&&d.offsetLeft!=undefined)b+=d.offsetLeft,c+=d.offsetTop,d=d.offsetParent;return{left:b,top:c}},this.mouseRelativeCoords=function(a,b){var c=this.domOffset(a),d=this.mouseCoords(b);return{x:d.x-c.left,y:d.y-c.top}},this.offsetPoint=function(a,b,c){return{x:a.x+b,y:a.y+c}},this.getBtnType=function(a){var c=BTN_LEFT;return b==BS_MSIE?a.button==1?c=BTN_LEFT:a.button==4?c=BTN_MID:a.button==2&&(c=BTN_RIGHT):a.button==0?c=BTN_LEFT:a.button==1?c=BTN_MID:a.button==2&&(c=BTN_RIGHT),c},this.makeMouseEvent=function(a,c,d,e){var f=0;return b==BS_MSIE?(d==BTN_LEFT&&(f=1),d==BTN_MID&&(f=4),d==BTN_RIGHT&&(f=2)):(d==BTN_LEFT&&(f=0),d==BTN_MID&&(f=1),d==BTN_RIGHT&&(f=2)),{pageX:a,pageY:c,button:f,srcElement:e}},this.setCSS=function(a,b,c){b=="float"?(a.style.styleFloat=c,a.style.cssFloat=c):b.toLowerCase()=="display"?(this.isIE()&&c.toLowerCase()=="none"&&this._setCommCSS(a,b,"block"),this._setCommCSS(a,b,c)):b=="opacity"?a.filters?TQ.isIE6()||TQ.isIE7()||TQ.isIE8()?a.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity="+c+");":a.style.filter="Alpha(opacity="+c+")":(a.style.opacity=c/100,a.style["-moz-opacity"]=c/100):b=="select"?(a.style["-moz-user-select"]=c,a.style["-webkit-user-select"]=c,a.style["-ms-user-select"]=c,a.style["-khtml-user-select"]=c,a.style[" user-select"]=c,this._fixOldIESelectCSS(a,c)):this._setCommCSS(a,b,c)},this.showElem=function(a){this.setCSS(a,"display","block")},this.hideElem=function(a){this.setCSS(a,"display","none")},this._fixOldIESelectCSS=function(a,b){if(!TQ.isLessVerIE(11))return;b=="none"?a.onselectstart=function(a){var a=a?a:window.event,b=a.srcElement.tagName.toLowerCase();return b=="input"||b=="textarea"}:a.onselectstart=function(){return TQ.stopPropagation(),!0}},this._setCommCSS=function(a,b,c){try{a.style[b]=c}catch(d){log("*error: setCSS["+b+"]:"+c)}},this.curCSS=function(a,b){var c="";if(a.currentStyle&&a.currentStyle[b])c=a.currentStyle[b];else if(window.getComputedStyle){var d=window.getComputedStyle(a,null);d&&(c=d[b])}else a.style&&a.style[b]&&(c=a.style[b]);return c},this.getCSS=function(a,b){var c="";return a.style&&a.style[b]?c=a.style[b]:a.style&&b=="float"&&(a.style.styleFloat?c=a.style.styleFloat:a.style.cssFloat&&(c=a.style.cssFloat)),c},this.append=function(a,b){a.appendChild(b)},this.remove=function(a,b){a.removeChild(b)},this.deleteDom=function(c){b==BS_MSIE&&(g||(g=a.createDom("div")),g.appendChild(c),g.innerHTML="")},this.setAttr=function(a,b,c){a.setAttribute(b,c)},this.setHtml=function(a,b){try{a.innerHTML=b}catch(c){alert(b)}},this.setRichText=function(a,b){this.setHtml(a,b)},this.setText=function(a,c){try{b==BS_FIREFOX?a.textContent=c:a.innerText=c}catch(d){alert(c)}},this.setTextEx=function(a,b){typeof b=="string"&&b.indexOf("<")>=0?(this.setText(a,""),this.setHtml(a,b)):(this.setHtml(a,""),this.setText(a,b))},this.getTextEx=function(a){return a.innerText!==""?a.innerText:a.innerHTML!==""?a.innerHTML:""},this.dictCopy=function(b,c){var d=a.getTypeof(c);d=="dict"?p(null,null,null,b,c):d=="array"?o(b,c):(alert(d),alert("disc copy type error"))},this.getTypeof=function(a){var b=typeof a;return b=="object"&&(a instanceof Array?b="array":b="dict"),b},this.formatTime=function(a,b){return q(a,b)},this.formatTimeMin=function(a){var b=parseInt(a/60),c=parseInt(a-b*60),d=r(b,2)+":";return d+=r(c,2),d},this.formatDateTime=function(a){return this._formatDateTime(a,"datetime")},this.formatDate=function(a){return this._formatDateTime(a,"date")},this.formatShortDateTime=function(a){return this._formatDateTime(a,"shortdatetime")},this.formatShortDate=function(a){return this._formatDateTime(a,"shortdate")},this._formatDateTime=function(a,b){f.setTime(a*1e3);var c=f.getYear();c=c<1900?1900+c:c;var d=r(f.getMonth()+1,2),e=r(f.getDate(),2),g=r(f.getHours(),2),h=r(f.getMinutes(),2),a=r(f.getSeconds(),2),i=c+"-"+d+"-"+e;return b=="datetime"&&(i+=" "+g+":"+h+":"+a),b=="shortdatetime"&&(d=f.getMonth()+1,e=f.getDate(),i=d+"月"+e+"日",i+=g+":"+h+":"+a),b=="shortdate"&&(d=f.getMonth()+1,e=f.getDate(),i=d+"月"+e+"日"),i},this.isSameDay=function(a,b){f.setTime(a*1e3);var c=f.getYear(),d=f.getMonth(),e=f.getDate();f.setTime(b*1e3);var g=f.getYear(),h=f.getMonth(),i=f.getDate();return c==g&&d==h&&e==i},this.getTextWidth=function(a){var b=0,c=a.replace(/[\x00-\xff]/g,"7|").replace(/[^\x00-\xff]/g,"13|").split("|");for(var d=0;d<c.length;d++)b+=parseInt(c[d])||0;return b},this.trim=function(a){return this.trimRight(this.trimLeft(a))},this.trimLeft=function(a){return a.replace(/^\s+/,"")},this.trimRight=function(a){return a.replace(/\s+$/,"")},this.initArray=function(a,b,c){for(var d=0;d<a.length;++d)a[d]=c;for(var d=a.length;d<b;++d)a.push(c)},this.encodeMsgByBytesLimit=function(a,b){var c=this.encodeMessage(a),d=UnicodeStr.byteSubStr(c,b);return EscapeString.subStr(c,d.length)},this.encodeMessage=function(a){var b=a.replace(/%/g,"&bfh;");return b=b.replace(/#\[\s.A/g,"*[A"),b=b.replace(/\[/g,"&dkhl;"),b=b.replace(/\]/g,"&dkhr;"),b=b.replace(/\"/g,"&quot;"),b=b.replace(/\'/g,"&apos;"),b=b.replace(/\r\n/g,"&hcj;"),b=b.replace(/\r/g,"&hck;"),b=b.replace(/\n/g,"&hcl;"),b},this.decodeMessage=function(a,b){var c=a.replace(/&bfh;/g,"%");return c=c.replace(/&dkhl;/g,"["),c=c.replace(/&dkhr;/g,"]"),c=c.replace(/</g,"&lt;"),c=c.replace(/>/g,"&gt;"),c=c.replace(/&hcj;/g,"<br/>"),c=c.replace(/&hck;/g,"<br/>"),c=c.replace(/&hcl;/g,"<br/>"),c=c.replace(/&apos;/g,"'"),c=c.replace(/ /g,"&nbsp;"),c},this.decodeMessageForText=function(a,b){var c=a.replace(/&bfh;/g,"%"),d=c.replace(/&dkhl;/g,"["),e=d.replace(/&dkhr;/g,"]"),f=e.replace(/&quot;/g,'"'),g=f.replace(/&apos;/g,"'"),h=g.replace(/&hcj;/g,"\r\n"),i=h.replace(/&hck;/g,"\r"),j=i.replace(/&hcl;/g,"\n"),k=j.replace(/&lt;/g,"<"),l=k.replace(/&gt;/g,">");return l},this.decodeMessageEx=function(a,b){var c=a.replace(/&bfh;/g,"%"),d=c.replace(/&dkhl;/g,"["),e=d.replace(/&dkhr;/g,"]"),f=e.replace(/&hcj;/g,"\r\n"),g=f.replace(/&hck;/g,"\r"),h=g.replace(/&hcl;/g,"\n"),i=h.replace(/&apos;/g,"'");return i},this.decodeMessageForChat=function(a){var b=a.replace(/</g,"&lt;");return b=b.replace(/>/g,"&gt;"),b},this.insertAtCursor=function(a,b){if(a.createTextRange&&a.caretPos){var c=a.caretPos;c.text=c.text.charAt(c.text.length-1)==" "?b+" ":b,this.setCaretPos(a,a.caretPosVal+b.length)}else if(document.selection){var d=a.createTextRange();d.text=a.value,d.collapse(!1);var e=document.selection.createRange();e.text=b,e.select()}else if(a.selectionStart||a.selectionStart=="0"){a.focus();var f=a.selectionStart,g=a.selectionEnd;a.value=a.value.substring(0,f)+b+a.value.substring(g,a.value.length),f+=b.length,a.selectionStart=f,a.selectionEnd=f}else a.focus(),a.value+=b},this.getDomWidth=function(a){return a.w_?a.w_:a.offsetWidth},this.getDomAutoWidth=function(a){return a.offsetWidth},this.getDomHeight=function(a){return a.h_?a.h_:a.offsetHeight},this.getDomAutoHeight=function(a){return a.offsetHeight},this.setDomRect=function(a,b,c,d,e){this.setDomPos(a,b,c),this.setDomSize(a,d,e)},this.setDomPos=function(a,b,c){TQ.setDomLeft(a,b),TQ.setDomTop(a,c)},this.setDomLeft=function(a,b){TQ.setCSS(a,"left",b+"px")},this.setDomTop=function(a,b){TQ.setCSS(a,"top",b+"px")},this.setDomSize=function(a,b,c){this.setDomWidth(a,b),this.setDomHeight(a,c)},this.setDomWidth=function(a,b){b=="auto"?(TQ.setCSS(a,"width","auto"),a.w_=null):(TQ.setCSS(a,"width",b+"px"),a.w_=b)},this.setDomHeight=function(a,b){b=="auto"?(TQ.setCSS(a,"height","auto"),a.h_=null):(TQ.setCSS(a,"height",b+"px"),a.h_=b)},this.getDomRect=function(a){var b=parseInt(TQ.getCSS(a,"left"),10),c=parseInt(TQ.getCSS(a,"top"),10),d=parseInt(TQ.getCSS(a,"width"),10),e=parseInt(TQ.getCSS(a,"height"),10);return{l:b,t:c,w:d,h:e}},this.getDomSize=function(a){var b=this.getDomRect(a);return{cx:b.w,cy:b.h}},this.getDomPos=function(a){var b=this.getDomRect(a);return{x:b.l,y:b.t}},this.isFunction=function(a){return typeof a=="function"},this.getHTMLElementPosition=function(a){var b=document.documentElement,c=window,d=null;return this.isFunction(a.getBoundingClientRect)?d=a.getBoundingClientRect():a instanceof HTMLCanvasElement?d={left:0,top:0,width:a.width,height:a.height}:d={left:0,top:0,width:parseInt(a.style.width),height:parseInt(a.style.height)},{left:d.left+c.pageXOffset-b.clientLeft,top:d.top+c.pageYOffset-b.clientTop,width:d.width,height:d.height}},this.captureTouchEvent=function(a,b){var c=!1,d=navigator,e=document,f=e.documentElement,c=f.ontouchstart!==undefined||e.ontouchstart!==undefined||d.msPointerEnabled;if(!c)return;var g=this,h=[],i=function(a){for(var b=0;b<a.length;b++){var c=a[b];if(c.identifier===h[0].identifier)return c}return null},j=function(c){if(!c.targetTouches)return;if(c.targetTouches.length>1)return;if(h.length>0)return;var d=c.targetTouches[0];if(b.isCanCapture&&!b.isCanCapture({pageX:d.pageX,pageY:d.pageY}))return;h.push(d),TQ.addEvent(a,"touchmove",k),TQ.addEvent(a,"touchend",l),TQ.addEvent(a,"touchcancel",m),b.touchStart&&b.touchStart.call(b.self,c,d,a),c.preventDefault(),a.focus()},k=function(c){if(!c.changedTouches)return;if(h.length!=1)return;var d=i(c.changedTouches);if(!d)return;b.touchMove&&b.touchMove.call(b.self,c,d,a),c.preventDefault()},l=function(c){if(!c.changedTouches)return;if(h.length!=1)return;var d=i(c.changedTouches);if(!d)return;b.touchEnd&&b.touchEnd.call(b.self,c,d,a),h.length=0,TQ.removeEvent(document,"touchmove",k),TQ.removeEvent(document,"touchend",l),TQ.removeEvent(document,"touchcancel",m),c.preventDefault()},m=function(){if(!event.changedTouches)return;if(h.length!=1)return;var c=i(event.changedTouches);if(!c)return;b.touchCancel&&b.touchCancel.call(b.self,event,c,a),h.length=0,TQ.removeEvent(document,"touchmove",k),TQ.removeEvent(document,"touchend",l),TQ.removeEvent(document,"touchcancel",m),event.preventDefault()};TQ.addEvent(a,"touchstart",j)},this.captureMouseEvent=function(a,b){if(document.documentElement.onmouseup===undefined)return;var c=function(a){return a=a?a:window.event,b.mouseMove.call(b.self,a),TQ.preventDefault(a),!0},d=function(a){return a=a?a:window.event,b.mouseUp&&b.mouseUp.call(b.self,a),this.releaseCapture?this.releaseCapture():window.captureEvents&&window.captureEvents(Event.MOUSEUP),TQ.removeEvent(document,"mouseup",d),b.mouseMove&&TQ.removeEvent(document,"mousemove",c),TQ.preventDefault(a),!0},e=function(a){a=a?a:window.event;var e=a.srcElement.tagName.toLowerCase();return e=="textarea"?!1:(b.mouseDown&&b.mouseDown.call(b.self,a),b.isCanCapture&&!b.isCanCapture(a)?!0:(this.setCapture?this.setCapture():window.captureEvents&&window.captureEvents(Event.MOUSEUP),b.mouseMove&&TQ.addEvent(document,"mousemove",c),TQ.addEvent(document,"mouseup",d),TQ.preventDefault(a),!0))};TQ.addEvent(a,"mousedown",e)},this.getDomOutWidth=function(a){return s(a)},this.getDomMarginWidth=function(a){return t(a)},this.saveTextareaPos=function(c){b==BS_MSIE&&(a.addEvent(c,"keydown",function(a){u(c)}),a.addEvent(c,"keyup",function(a){u(c)}),a.addEvent(c,"mousedown",function(a){u(c)}),a.addEvent(c,"mouseup",function(a){u(c)}),a.addEvent(c,"focus",function(a){u(c)}))},this.isInRect=function(a,b){return b.x>=a.x&&b.x<a.x+a.w&&b.y>=a.y&&b.y<a.y+a.h},this.isInRhombus=function(b,c){var d=!1;if(a.isInRect(b,c)){var e=parseInt(b.w/2),f=parseInt(b.h/2),g=c.x-b.x,h=c.y-b.y,i=(g+e)%b.w,j=h%b.h,k=i<=e?i:b.w-i,l=parseInt(f*k/e);j>=l&&j<=b.h-l&&(d=!0)}return d},this.formatNumber=function(a,b){return r(a,b)},this.setFocus=function(a){setTimeout(function(){try{a.focus()}catch(b){}},0)},this.moveCaretEnd=function(a){this.setCaretPos(a,a.value.length)},this.setCaretPos=function(a,b){try{if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()}else!a.setSelectionRange}catch(d){}};var m=function(){var a=BS_UNKNOWN,b=navigator.userAgent;return b.indexOf("Firefox")!=-1?a=BS_FIREFOX:b.indexOf("Opera")!=-1?a=BS_OPERA:b.indexOf("MSIE")!=-1?(a=BS_MSIE,c=parseFloat(b.match(/MSIE( )(\d+(\.\d+)?)/)[2])):b.indexOf("Chrome")!=-1?a=BS_CHROME:b.indexOf("Safari")!=-1&&b.indexOf("Apple")!=-1?a=BS_SAFARI:navigator.product=="Gecko"?a=BS_MOZILLA:navigator.vendor=="Netscape"&&(a=BS_NETSCAPE),a},n=function(){if(e==null){var a=document;e=a.compatMode==="CSS1Compat"?a.documentElement:a.body}return e},o=function(b,c){var d=null,e=0;if(!(c.length>0))return;d=c[0]._k;var f=c[0]._r;d||f?e=1:!d&&c[0]["id"]!=undefined&&(d="id");if(!d){b.length=0;for(var g=e;g<c.length;++g)b.push(c[g]);return}for(var g=e;g<c.length;++g){var h=c[g],i=a.find(b,d,h[d]);h._d&&i?a.removeElement(b,a.getLastFindIdx()):i?p(null,null,null,i,h):h._d||(b.push({}),p(null,null,null,b[b.length-1],h))}},p=function(b,c,d,e,f){for(k in f){var g=f[k],h=a.getTypeof(g);h=="dict"?(e[k]||(e[k]={}),p(e,h,k,e[k],g)):h=="array"?(e[k]||(e[k]=[]),o(e[k],g)):c=="dict"&&k=="_d"?b[d]=null:e[k]=g}},q=function(a,b){b<0&&(b=0);var c=parseInt(b/3600),d=parseInt((b-c*3600)/60),e=parseInt(b-c*3600-d*60),f=":",g=":",h="";if(a==1||a==2)f="小时",g="分",h="秒";var i="";if(a==0||a==1||c>0)i+=r(c,2)+f;return i+=r(d,2)+g,i+=r(e,2)+h,i},r=function(a,b){var c=1,d=parseInt(a/10);while(d>0){++c;if(c>=b)return a;d=parseInt(d/10)}var e="";for(var f=c;f<b;++f)e+="0";return e+=a,e},s=function(a){return TQ.getDomWidth(a)+t(a)},t=function(a){var b=parseInt(TQ.curCSS(a,"marginLeft"),10)+parseInt(TQ.curCSS(a,"marginRight"),10);return isNaN&&isNaN(b)&&(b=0),b},u=function(a){if(a.createTextRange)try{var b=document.selection.createRange();a.caretPos=b.duplicate();var c=a.createTextRange();c.collapse(!0),c.select();var d=document.selection.createRange();d.setEndPoint("EndToEnd",b),a.caretPosVal=d.text.length,b.select()}catch(e){}};this.initialize.apply(this,arguments)},IMG=new function(){var a,b="office";this.initialize=function(){},this.setGameObj=function(b){a=b},this.getMode=function(){return b},this.setBKImage=function(a,b,c){if(TQ.isIE6()&&b.indexOf(".png")>0){var d="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+b+"')";TQ.setCSS(a,"filter",d),a.style.backgroundImage="none"}else a.style.backgroundImage="url('"+b+"')",TQ.fixIE6Png(a);c&&(a.style.backgroundPosition=c)},this.getBKImage=function(a){return a.style.backgroundImage},this.makeBigImg=function(a,d){return d=d?"_"+d:"",c(b+"/item/big/"+a+d+".gif")},this.makeMidImg=function(a,d){return d=d?"_"+d:"",c(b+"/item/mid/"+a+d+".gif")},this.makeSmallImg=function(a,d){return d=d?"_"+d:"",c(b+"/item/small/"+a+d+".gif")},this.makeInBuildImg=function(a,d,e){var f=e==0?"_n":"_n",g=d?"_h":"",h=".png";if(a==FIXID.WALLBUILD||a==FIXID.GOV_BUILD)h=".gif";return c(b+"/build/block/"+a+f+g+h)},this.makeFarmBuildImg=function(a,d,e){var f="_"+e,g=d?"_h":"";return c(b+"/farm/block/"+a+f+g+".gif")},this.makeAlliBuildImg=function(a,d){var e=d?"_h":"_n";return c(b+"/alli/build/"+a+e+".gif")},this.makeImg=function(a){return c(b+"/"+a)},this.makeHelpImg=function(a){var d=".gif";return a<1e4&&(d=".jpg"),c(b+"/helpimg/"+a+d)},this.makeGroupPosImg=function(a){var d="";return a>0&&(d=c(b+"/chat/group/pos/"+a+".gif")),d},this.makeStepoutImg=function(a){var d="";return a==0&&(d=c(b+"/ui/back/team/stepoutflag.gif")),d},this.makeFaceImg=function(a,d,e){var f=b+"/chat/face/"+TQ.formatNumber(a,2)+"/",g=f+TQ.formatNumber(e,2);return d==0&&(g+="_x"),g+=".gif",c(g)},this.makeStateCityFlag=function(a){return c(b+"/statecity/flag/new/"+a)},this.makeSmallStateCityFlag=function(a){return c(b+"/statecity/sflag/new/"+a)},this.makeYellowDiamondImg=function(a,b){return this._makeQQCommDiamondImg("yd",a,b)},this.makeYellowDiamondYearImg=function(a){return this._makeQQCommDiamondYearImg("yd",a)},this.makeBlueDiamondImg=function(a,b){return this._makeQQCommDiamondImg("bd",a,b)},this.makeBlueDiamondYearImg=function(a){return this._makeQQCommDiamondYearImg("bd",a)},this._makeQQCommDiamondImg=function(a,d,e){var f=".gif";return d=="ui"&&(f=".png"),c(b+"/qq/"+a+"/flag/"+d+"/"+e+f)},this._makeQQCommDiamondYearImg=function(a,d){var e=".gif";return d=="ui"&&(e=".png"),c(b+"/qq/"+a+"/flag/year"+e)},this.getItemTalk=function(){return c(b+"/chat/itemtalk.gif")},this.getBuildedFlag=function(){return c(b+"/build/buildedflag.gif")},this.getFullBuildedFlag=function(){return c(b+"/build/fullbulidedflag.gif")},this.getBuyLimitFlag=function(){return c(b+"/shopdlg/limit.png")},this.getCursorImg=function(a,d,e){return d||e?"url("+c(b+"/"+a)+") "+d+" "+e+", auto":"url("+c(b+"/"+a)+"),auto"},this.getChatTag=function(a){var d={};d[CHAT_TAG.SYS]="sys",d[CHAT_TAG.WORLD]="world",d[CHAT_TAG.ALLIANCE]="alliance",d[CHAT_TAG.STATE]="state",d[CHAT_TAG.PRIVATE]="private",d[CHAT_TAG.PROMPT]="prompt";for(var e=9900001;e<=9900004;++e)d[e]="newcitys/"+e;var f=d[a];f||(f=a);var g="/chat/flagtag/"+f+".gif";return TQ.isMobile()&&(g="/mb"+g),c(b+g)},this.makeChatTagDiv=function(a){var b="ui_chat_imgtag";return TQ.isMobile()&&(b="mb_ui_chat_imgtag"),this.makeCommChatTagDiv(b,"<div class=inner_img style=\"BACKGROUND:url('"+IMG.getChatTag(a)+"') 0px 0px no-repeat;\"></div>")},this.makeVipChatTagDiv=function(a){var b=this.makeImg("vip/small/"+a+".gif");return this.makeCommChatTagDiv("ui_chat_viptag","<div class=inner_img style=\"BACKGROUND:url('"+b+"') 0px 4px no-repeat;\"></div>")},this.makeBlueGrowChatTagDiv=function(a){var b=this.makeBlueGrowImg(a);return this.makeCommChatTagDiv("ui_chat_growtag","<div class=inner_img style=\"BACKGROUND:url('"+b+"') 0px 3px no-repeat;\"></div>")},this.makeBlueGrowImg=function(a){return this.makeImg("qq/bd/grow/chat/1.gif")},this.makeCommChatTagDiv=function(a,b){var c=a;if(TQ.isIE6()||TQ.isIE7()||TQ.isIE8())c+="_fixie";return"<div class="+c+">"+b+"</div>"},this.getAvatarImg=function(a){return c(b+"/avatar/"+a+".gif")},this.getCityNameImgByLevel=function(a){var d=TQ.formatNumber(a,2);return c(b+"/briefresbar/levels/"+d+".gif")},this.getCityBigLevelIcon=function(a){return c(b+"/achievement/bigcitylevels/"+a+".gif")},this.getActTowerIcon=function(a){var d=a?"":"_d";return c(b+"/achievement/acttower"+d+".gif")},this.getActTerraceIcon=function(a){var d=a?"":"_d";return c(b+"/achievement/actterrace"+d+".gif")},this.getVipIcon=function(a){var d=a?"":"_d";return c(b+"/achievement/vip"+d+".gif")},this.getImgNumber=function(a,d){var e={com:{cx:8,cy:9}},f=e[a],g="",h=d.toString();for(var i=h.length-1;i>=0;--i){var j="FLOAT:right;";j+="WIDTH:"+f.cx+"px;",j+="HEIGHT:"+f.cy+"px;",j+="BACKGROUND:url("+c(b+"/imgnum/"+a+"/"+h.substr(i,1)+".gif")+") no-repeat;",g+='<div style="'+j+'"></div>'}return g},this.getSound=function(a){return c(b+"/sound/"+a)};var c=function(a){if(a.indexOf("v=")>0)return;var b="0",c=d(a);return!res_images[c]||(res_images[c][a]?b=res_images[c][a]:b=res_images[c].v),image_base_url+a+"?v="+b},d=function(a){var b=0;for(var c=0;c<a.length;++c)b=(31*b+a.charCodeAt(c))%4294967295;return b};this.initialize.apply(this,arguments)},ItemResUtil=Class.extern(function(){this.initItemsres=function(a,b){b=b?b:"resid";for(var c=0;c<a.length;++c){var d=a[c];this.initItemres(d,b)}},this.initItemres=function(a,b){if(a.itemres&&a.itemres.id==a[b])return;a.itemres=this.findItemres(a[b])},this.findItemres=function(a){if(!a)return null;var b=TQ.qfind(res_test_items,"id",a);return b?b:(b=TQ.qfind(res_items_ex,"id",a),b?b:(b=TQ.qfind(res_items_base,"id",a),b?b:(b=TQ.qfind(res_items,"id",a),b?b:(b=TQ.qfind(res_items_builds,"id",a),b?b:(b=TQ.qfind(res_items_farms,"id",a),b?b:(b=TQ.qfind(res_items_heroskills,"id",a),b?b:(b=TQ.qfind(res_fields,"id",a),b?b:(b=TQ.qfind(res_items_soldiers,"id",a),b?b:(b=TQ.qfind(res_items_cultures,"id",a),b?b:(b=TQ.qfind(res_lineup,"id",a),b?b:(b=TQ.qfind(res_drops,"id",a),b?b:(b=TQ.qfind(res_copyfields,"id",a),b?b:(b=TQ.qfind(res_fieldheros,"id",a),b?b:(b=TQ.qfind(res_citydef,"id",a),b?b:(b=TQ.qfind(res_npcs,"id",a),b?b:(log("* not find resid: "+a),null))))))))))))))))},this.findBuildLevelres=function(a,b){var c=TQ.qfind(res_inbuild,"id",a*1e3+b);return c?c:(c=TQ.qfind(res_cultures_upd,"id",a*1e3+b),c?c:null)},this.findEffectres=function(a,b){var c=this.findItemres(a);return c==null?null:TQ.qfind(c.effects,"id",b)},this.findEffectItems=function(a){var b=TQ.qfind(res_efftiems_ex,"id",a);return b?b:(b=TQ.qfind(res_efftiems,"id",a),b?b:null)},this.findCultureLevelres=function(a,b){return TQ.qfind(res_cultures_upd,"id",this.makeLevelResid(a,b))},this.findFieldLevelres=function(a,b){return TQ.qfind(res_fields_level,"id",this.makeLevelResid(a,b))},this.findTaskRes=function(a){var b=TQ.qfind(res_tasks,"id",a);return b?b:(b=TQ.qfind(res_activityval_tasks,"id",a),b?b:(b=TQ.qfind(res_newhelp_tasks,"id",a),b?b:null))},this.findHelpRes=function(a){var b=TQ.qfind(res_newhelp_tasks,"id",a);return b?b:(b=TQ.qfind(res_all_helps,"id",a),b?b:null)},this.splitResidLevel=function(a){return{resid:parseInt(a/1e3,10),level:a%1e3}},this.makeLevelResid=function(a,b){return a*1e3+b}}).snew()