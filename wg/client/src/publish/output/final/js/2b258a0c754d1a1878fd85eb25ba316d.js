ClickItemHdr=Class.extern(function(){this.init=function(a){this.g_=a,this.tip_=null,this.pos_={x:0,y:0},this.roleId_=0,this.item_={},this.g_.regEvent(EVT.NET,NETCMD.ITEM,this,this._onSvrPkg)},this.click=function(a,b,c){this._createTip(),this.tip_.hide(),this.pos_=a,this.roleId_=b,this.item_=c,this._isSelfItem()&&this._isUniqueItem()&&(this.item_=this.g_.getImgr().getItemById(this.item_.id)),!this._isSelfItem()&&this._isUniqueItem()?ItemInfoSender.sendGetDetailItem(this.g_,this.roleId_,this.item_.id):this.item_==null?this.g_.getGUI().sysMsgTips(SMT_NORMAL,rstr.ids[100168].msg):this.tip_.show(this.pos_)},this._createTip=function(){if(this.tip_)return;var a=TTIP.addTip(TQ.getUiBody(),"no");this.tip_=TTIP.getTipById(a),this.tip_.setFlag(TIP_FLAG.CUSTOM),this.tip_.setCaller({self:this,caller:this._onGetBlockTooltip})},this._onGetBlockTooltip=function(){return TIPM.getItemDesc(this.item_,this._isSelfItem()?"self":"other",!1)},this._onSvrPkg=function(a){var b=a.data;if(b.result<0)return;b.roleId==this.roleId_&&b.detailitem&&b.detailitem.id==this.item_.id&&(TQ.dictCopy(this.item_,b.detailitem),this.tip_.show(this.pos_))},this._isSelfItem=function(){return this.g_.getImgr().getRoleId()==this.roleId_},this._isUniqueItem=function(){return this.item_.itemres.pile&&this.item_.itemres.pile==1}})