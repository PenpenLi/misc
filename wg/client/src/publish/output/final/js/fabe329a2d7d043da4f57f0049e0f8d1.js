InBuildPanel=Class.extern(function(){var a=[{x:1284,y:527},{x:868,y:1264},{x:940,y:650},{x:1067,y:710},{x:1194,y:770},{x:1333,y:836},{x:1482,y:905},{x:1232,y:908},{x:1366,y:974},{x:583,y:831},{x:690,y:775},{x:785,y:722},{x:816,y:828},{x:912,y:775},{x:940,y:889},{x:1033,y:833},{x:534,y:1015},{x:649,y:1073},{x:782,y:1115},{x:658,y:958},{x:786,y:1018},{x:909,y:1072},{x:1033,y:1015},{x:112,y:581},{x:259,y:567},{x:153,y:676},{x:285,y:676},{x:124,y:761},{x:300,y:756},{x:215,y:819}],b=null,c=null,d=null,e=0;this.init=function(i,j){b=i,c=this,e=BUILDCITY_ID.MAIN;for(var k=0;k<a.length;++k)p=a[k],p.x+=106,p.y+=154;var l={cityResId:FIXID.MAINCITY,mapTitle:rstr.citylist.maincity,canUseBlockCnt:a.length,blockPoss:a,cityId:e};d=CommBuildPanel.snew(i,j,l);var m=b.getWinSizer().getValidClientSize(),n=Math.max(0,1200-m.cx);d.setFirstPos({x:n,y:430}),b.regEvent(EVT.LOGIN_OK,0,c,f),b.regEvent(EVT.SETCITYLEVEL,0,c,g),b.regEvent(EVT.NET,NETCMD.BUILDRES,c,h)},this.open=function(){d.open(),d.setBlocksCanUseCnt(i()),SoundMgr.playBackSound(res_baksounds.mainCity)},this.hide=function(){d.hide()},this.setViewPos=function(a){d.setViewportPos(a)},this.getViewPos=function(){return d.getViewport()},this.opSpeed=function(a){d.opSpeed(a)},this.opCancel=function(a){d.opCancel(a)},this.resize=function(a){d.resize(a)},this.setActive=function(a){d.setActive(a)},this.isActive=function(){return d.isActive()},this.resetViewPos=function(){d.resetViewPos()},this.getItems=function(){return d.getItems()},this.getCityType=function(){return CITY_TYPE.MAIN},this.getFirstFreeBlock=function(){var a=d.getBuildBlocks();for(var b=0;a.getCanUseBlockCnt();++b){var c=a.getBlock(b);if(!c.getItem())return c}return NullInBuildBlock},this.getBlocksByResId=function(a){var b=[],c=d.getBuildBlocks();for(var e=0;e<c.getCanUseBlockCnt();++e){var f=c.getBlock(e);if(!f||!f.getItem())continue;a.isSatisfiedBy(f.getItem())&&b.push(f)}return b};var f=function(){CityBuildSender.sendGetAllBuilds(b,e)},g=function(){d.setBlocksCanUseCnt(i())},h=function(a){var c=a.data;c.cityTypes&&(TQ.dictCopy(b.getImgr().getCityTypes(),c.cityTypes),b.sendEvent({eid:EVT.CITYTYPES,sid:0})),c.builds&&c.builds.cityId==e&&(d.handleSvrBuildsData(c.builds.list),HelpGuider.getNewcomerSpirit().refreshCurNewcomerTask()),c.openMainCity&&(d.open(),SoundMgr.playBackSound(res_baksounds.mainCity),g_loading.hide(),b.setState(GSTATE.INGAME),UIM.getDlg("newcomerhelper").handleCaches(),HelpGuider.enterGame(b))},i=function(){var a=b.getImgr().getCityLevel();return CityLevelUtil.getBlocksCntByCityLevel(a)}})