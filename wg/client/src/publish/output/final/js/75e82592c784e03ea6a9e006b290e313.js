Entity=function(){var a,b,c,d,e,f,g;this.init=function(h,i){a=h,b=i,d=null,c={x:0,y:0},e={cx:32,cy:32},f="img",g="avatar"},this.setDomType=function(a){f=a},this.setType=function(a){g=a},this.setClass=function(a){d.className=a},this.create=function(){d=document.createElement(f),b.appendChild(d),d.style.zIndex="1",d.style.position="absolute"},this.destroy=function(){d!=null&&(b.removeChild(d),d=null),b=null},this.setSize=function(a){e.cx=a.cx,e.cy=a.cy,TQ.setDomSize(d,e.cx,e.cy)},this.getSize=function(){return e},this.setPos=function(a){c.x=a.x,c.y=a.y,TQ.setDomPos(d,c.x,c.y)},this.show=function(){d!=null&&(d.style.display="block")},this.hide=function(){d!=null&&(d.style.display="none")},this.setRes=function(a,b){b=b?b:"";var c=a+b,d=g+"/"+c;d+=".gif",this.setImage(IMG.makeImg(d))},this.setImage=function(a){f=="img"?d.src=a:f=="bkimg"&&IMG.setBKImage(d,a)},this.setBKImage=function(a){IMG.setBKImage(d,a)},this.getDomObj=function(){return d},this.setZOrder=function(a){d.style.zIndex=a.toString()},this.setAlpha=function(a){TQ.setCSS(d,"opacity",parseInt(a*100))},this.init.apply(this,arguments)},ProgressBar=function(){var a,b,c,d;this.init=function(e,f){a=f,b=new Entity(e,a),c=0,d=100},this.setMaxVal=function(a){d=a,this.refreshBar()},this.getMaxVal=function(){return d},this.setVal=function(a){c=a,this.refreshBar()},this.getVal=function(){return c},this.refreshBar=function(){var a=b.getSize(),e=parseInt(a.cx*c/d)-a.cx,f=b.getDomObj();f.style.backgroundPosition=e+"px 50%"},this.setSize=function(a){b.setSize(a)},this.create=function(){b.create()},this.destroy=function(){b.destroy()},this.getEntity=function(){return b},this.setPos=function(a){b.setPos(a)},this.setBarBorder=function(a){b.setImage(a)},this.setBarImage=function(a){b.setBKImage(a)},this.setZOrder=function(a){b.setZOrder(a)},this.show=function(){b.show()},this.hide=function(){b.hide()},this.init.apply(this,arguments)},FrameEffect=function(){var a,b,c,d,e,f,g=0;this.init=function(g,h){b=h,c=new Entity(g,b),d={x:0,y:0},a=g,e=0,f=!1},this.setDurition=function(a){g=a},this.setSize=function(a){c.setSize(a)},this.create=function(){c.setDomType("div"),c.create(),e=a.getCurTimeMs()},this.destroy=function(){c.destroy()},this.setBKImage=function(a){c.setBKImage(a)},this.getEntity=function(){return c},this.setPos=function(a){d.x=a.x,d.y=a.y,c.setPos(a)},this.setZOrder=function(a){c.setZOrder(a)},this.update=function(a){var b=a-e;b>=g&&(f=!0)},this.start=function(){e=EUPD.getTime(),f=!1},this.isEnd=function(){return f},this.show=function(){c.show()},this.hide=function(){c.hide()},this.init.apply(this,arguments)},NumberEffect=function(){var a=.08,b=50,c=80,d,e,f,g,h,i,j,k=b;this.initialize=function(a,b){e=b,f=new Entity(a,e),g=new Entity(a,e),h={x:0,y:0},d=a,i=0,j=!1},this.setNumber=function(a){var b=f.getDomObj();b.innerHTML=a,b=g.getDomObj(),b.innerHTML=a},this.setSize=function(a){f.setSize(a),g.setSize(a)},this.create=function(){f.setDomType("div"),f.create(),i=d.getCurTimeMs(),g.setDomType("div"),g.create(),g.setClass("upnumback")},this.destroy=function(){f.destroy(),g.destroy()},this.getEntity=function(){return f},this.getBakEntity=function(){return g},this.setPos=function(a){h.x=a.x,h.y=a.y,f.setPos(a),g.setPos({x:a.x+1,y:a.y+1})},this.setZOrder=function(a){f.setZOrder(a),g.setZOrder(a-1)},this.update=function(b){var d=b-i,e=a*d;e=e<k?e:k;var l=parseInt(d*e/1e3,10);l>=c&&(l=c,j=!0);var m=c/2,n=1;l>m&&(n=1-(l-m)/m),f.setPos({x:h.x,y:h.y-l}),f.setAlpha(n),g.setPos({x:h.x+1,y:h.y-l+1}),g.setAlpha(n)},this.start=function(){i=EUPD.getTime(),j=!1},this.isEnd=function(){return j},this.show=function(){f.show(),g.show()},this.hide=function(){f.hide(),g.hide()},this.setSpeed=function(a){k=a},this.initialize.apply(this,arguments)},ImageEffect=function(){var a=.2,b=120,c=280,d,e,f,g,h,i,j=b;this.initialize=function(a,b){e=b,f=new Entity(a,e),g={x:0,y:0},d=a,h=0,i=!1},this.setImageClass=function(a){f.setClass(a)},this.setSize=function(a){f.setSize(a)},this.create=function(){f.setDomType("div"),f.create(),h=d.getCurTimeMs()},this.destroy=function(){f.destroy()},this.getEntity=function(){return f},this.setPos=function(a){g.x=a.x,g.y=a.y,f.setPos(a)},this.setZOrder=function(a){f.setZOrder(a)},this.update=function(b){var d=b-h,e=a*d;e=e<j?e:j;var k=parseInt(d*e/1e3,10);k>=c&&(k=c,i=!0);var l=c/2,m=1;k>l&&(m=1-(k-l)/l),f.setPos({x:g.x,y:g.y-k}),!TQ.isIE6()&&!TQ.isIE7()&&!TQ.isIE8()&&f.setAlpha(m)},this.start=function(){h=EUPD.getTime(),i=!1},this.isEnd=function(){return i},this.show=function(){f.show()},this.hide=function(){f.hide()},this.setSpeed=function(a){j=a},this.initialize.apply(this,arguments)},MapObject=function(){var a=-7,b=null,c=null,d=null,e=0,f=null,g=null,h=null,i=0;this.initialize=function(a,e){b=this,c=a,d=e},this.getEntity=function(){return f},this.setName=function(a){var b=g.getDomObj();TQ.setTextEx(b,a)},this.setNameTagImg=function(a){var b=g.getDomObj();IMG.setBKImage(b,a),TQ.fixIE6Png(b)},this.setId=function(a){e=a},this.getId=function(a){return e},this.setResId=function(a){w(a)},this.setSize=function(a){f.setSize(a)},this.create=function(){p(),q()},this.destroy=function(){r(),s()},this.setPos=function(a){v(a)},this.setCaller=function(a){h=a},this.show=function(){f.show(),g.show()},this.hide=function(){f.hide(),g.hide()},this.click=function(){l(null)};var j=function(a){x()},k=function(a){y()},l=function(a){h&&h.caller.call(h.self,e)},m=function(a){x()},n=function(a){y()},o=function(a){h&&h.caller.call(h.self,e)},p=function(){f=new Entity(c,d),f.setType("npc"),t(f,"bkimg",j,k,l)},q=function(){g=new Entity(c,d),t(g,"div",m,n,o),g.setClass("map_objecttag")},r=function(){u(f,j,k,l)},s=function(){u(f,m,n,o)},t=function(a,b,c,d,e){a.setDomType(b),a.create();var f=a.getDomObj();TQ.addEvent(f,"mouseover",c),TQ.addEvent(f,"mouseout",d),TQ.addEvent(f,"click",e)},u=function(a,b,c,d){var e=a.getDomObj();TQ.removeEvent(e,"mouseover",b),TQ.removeEvent(e,"mouseout",c),TQ.removeEvent(e,"click",d),a.destroy()},v=function(b){f.setPos(b);var c=f.getSize();g.setPos({x:b.x+c.cx/2-60,y:b.y+30-a})},w=function(a){i=a,f.setRes(i)},x=function(){f.setRes(i,"_h"),f.setClass("map_object"),g.setClass("map_objecttag")},y=function(){f.setRes(i),g.setClass("map_objecttag")};this.initialize.apply(this,arguments)},EntityFactory=function(){var a,b={},c=[],d=[],e=[],f=[],g=[],h=[];this.initialize=function(b){a=b},this.alloc=function(a){var c=i(b,Entity,a);return c.setType("avatar"),c},this.free=function(a){j(b,a)},this.allocPBar=function(a){return i(c,ProgressBar,a)},this.freePBar=function(a){j(c,a)},this.allocNumEffect=function(a){return i(d,NumberEffect,a)},this.freeNumEffect=function(a){j(d,a)},this.playImageEffect=function(a){var b=this.allocImageEffect(a.parent);b.setSize(a.size),b.setImageClass(a.imageClass),b.setZOrder(a.zorder),b.setPos(a.pos),b.start(),EUPD.appendEffect(b,this.freeImageEffect)},this.allocImageEffect=function(a){return i(e,ImageEffect,a)},this.freeImageEffect=function(a){j(e,a)},this.allocFrameEffect=function(a){return i(f,FrameEffect,a)},this.freeFrameEffect=function(a){j(f,a)},this.allocEffect=function(a){var b=this.alloc(a);return b.setType("effect"),b},this.freeEffect=function(a){this.free(a)},this.allocMapObj=function(a){return i(g,MapObject,a)},this.freeMapObj=function(a){j(g,a)};var i=function(b,c,d){var e=null,f=l(b,d);return f.length>0?(e=f[f.length-1],f.length=f.length-1,e.show()):(e=new c(a,d),e.create(),e._mapdom=d),e},j=function(a,b){if(b!=null){var c=l(a,b._mapdom);c.push(b),b.hide()}},k=function(a){for(var b=0;b<h.length;++b)if(h[b]==a)return b;return h.push(a),h.length-1},l=function(a,b){var c=k(b);return a[c]||(a[c]=[]),a[c]};this.initialize.apply(this,arguments)}