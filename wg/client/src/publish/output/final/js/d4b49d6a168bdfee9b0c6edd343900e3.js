BTN_TYPE={COMM:0,CHECK:1,TIMER:2,DELAY:3},ButtonBlinking=Class.extern(function(){var a=250,b=null,c=null,d=0,e=0,f=!1,g=null;this.init=function(a){b=this,g=a},this.start=function(b){c||(c=window.setInterval(h,a)),d=b>0?b:2147483647,e=0},this.stop=function(){i(!1),j(),k()},this.isBlinkingFrame=function(){return f};var h=function(){f=!f,e+=a,e>d?b.stop():k()},i=function(a){f=a},j=function(){c&&(window.clearInterval(c),c=null)},k=function(){g.caller.call(g.self)}}),NullButton=Class.extern(function(){this.clearCaller=function(){},this.resetUIBack=function(a){},this.getUIBack=function(){return{}},this.setCaller=function(a){},this.setCallerEx=function(a){},this.appendCaller=function(a){},this.unsetCaller=function(a){},this.setId=function(a){},this.getId=function(){return 0},this.setClass=function(a){},this.setText=function(a){},this.getText=function(){return""},this.setType=function(a){},this.getType=function(){return 0},this.setPress=function(a){},this.isPress=function(){return!1},this.getWidth=function(){return 0},this.enable=function(a){},this.setDisableCanClick=function(a){},this.show=function(){},this.hide=function(){},this.visible=function(){},this.hidden=function(){},this.getDom=function(){return null},this.isShow=function(){return!0},this.getParent=function(){return null},this.setDelay=function(a){},this.getDelay=function(){},this.isEnable=function(){return!0},this.click=function(){},this.startBlinking=function(a){},this.stopBlinking=function(){}}),ComButton=function(){var a=80,b,c,d,e,f,g,h=[],i,j,k,l,m,n,o,p=null,q=0,r=uiback.btn.comm,s,t=1e3,u="static",v="0",w=!1,x=!1,y=null,z=null,A=!1,B={x:0,y:0};this.init=function(a,f,g){b=a,d=f,c=this,k=0,l=BTN_TYPE.COMM,m=!0,i=!1,j=!1,s=!0,p=null,m_posEvent=null,e=TQ.createDom("div"),TQ.append(d,e),g&&g.uiback&&(r=g.uiback),X(),C(),P()},this.clearCaller=function(){h=[]},this.resetUIBack=function(a){if(r==a)return;r=a,P()},this.getUIBack=function(){return r},this.setCaller=function(a){a&&(E(a)||h.push(a),P())},this.setCallerEx=function(a){a&&(h=[a],P())},this.appendCaller=function(a){a&&(E(a)||h.push(a),P())},this.unsetCaller=function(a){TQ.find(h,null,a)&&TQ.removeElement(h,TQ.getLastFindIdx())},this.setId=function(a){k=a},this.getId=function(){return k},this.setClass=function(a){log(a.normal+","+a.press)},this.setText=function(a){TQ.setHtml(f,a);var c=TQ.getTextWidth(a);e!=g&&c>0&&TQ.setDomWidth(g,c),b.getGUI().setUIBack(e,-1,-1,r.type)},this.getText=function(){return f.innerHTML},this.setType=function(a){l=a},this.getType=function(){return l},this.setPress=function(a){i=a,P()},this.isPress=function(){return i},this.getWidth=function(){return TQ.getDomWidth(e)},this.enable=function(a){if(l==BTN_TYPE.DELAY&&!m)return;F(a)},this.setDisableCanClick=function(a){w=a},this.show=function(){TQ.setCSS(e,"display","block"),s=!0},this.hide=function(){TQ.setCSS(e,"display","none"),s=!1},this.visible=function(){TQ.setCSS(e,"visibility","visible"),s=!0},this.hidden=function(){TQ.setCSS(e,"visibility","hidden"),s=!1},this.getDom=function(){return e},this.isShow=function(){return s},this.getParent=function(){return d},this.setDelay=function(a){t=a},this.getDelay=function(){return t},this.isEnable=function(){return m},this.click=function(){l==BTN_TYPE.CHECK&&(i=!i),$(),P()},this.startBlinking=function(a){y||(y=ButtonBlinking.snew({self:c,caller:P})),y.start(a)},this.stopBlinking=function(){y&&y.stop()},this.setNewFlag=function(a){if(a&&r.newFlag){if(!z){z=TQ.createDom("div"),TQ.append(e,z),TQ.setClass(z,r.newFlag.cls);var b=TQ.domOffset(d),c=TQ.domOffset(e),f={left:c.left-b.left,top:c.top-b.top};if(r.newFlag.pos)B.x=f.left+r.newFlag.pos.x,B.y=f.top+r.newFlag.pos.y;else{var g=TQ.getDomWidth(z),h=TQ.getDomWidth(e),i=h-g;B.x=f.left+i,B.y=0}TQ.setDomPos(z,B.x,B.y)}TQ.setCSS(z,"display","block"),A=!0}else z&&(TQ.setCSS(z,"display","none"),A=!1)},this.getNewFlag=function(){return A};var C=function(){if(r.type==0)D(e);else{var a=e.childNodes;for(var b=0;b<a.length;++b)D(a[b])}},D=function(a){TQ.addEvent(a,"dragstart",function(a){return!1}),TQ.addEvent(a,"selectstart",function(a){return!1}),TQ.addEvent(a,"mouseover",N),TQ.addEvent(a,"mouseout",O),isPcBrowser()&&TQ.captureMouseEvent(a,{self:c,mouseDown:I,mouseUp:J}),TQ.captureTouchEvent(a,{self:c,touchStart:G,touchEnd:H,touchCancel:H})},E=function(a){for(var b=0;b<h.length;++b)if(h[b].self==a.self&&h[b].caller==a.caller)return!0;return!1},F=function(a){m=a,P()},G=function(a,b,c){K(TQ.makeMouseEvent(b.pageX,b.pageY,BTN_LEFT,c)),j=!0},H=function(a,b,c){L(TQ.makeMouseEvent(b.pageX,b.pageY,BTN_LEFT,c)),j=!1},I=function(a){K(a)},J=function(a){L(a)},K=function(c){p=c?c:window.event;if(TQ.getBtnType(p)!=BTN_LEFT)return;if(!m)return;l==BTN_TYPE.CHECK&&(i=!i),m_posEvent=TQ.cloneEvent(p),x=!0,TQ.stopPropagation(p),b.sendEvent({eid:EVT.MOUSEDOWN,sid:0,event:p}),SoundMgr.playSound(res_sounds.clickBtnDown),P(),l==BTN_TYPE.CHECK?$():l==BTN_TYPE.TIMER&&h.length>0&&(n=window.setInterval(V,a),q=0)},L=function(a){p=a?a:window.event;if(TQ.getBtnType(p)!=BTN_LEFT)return;W(n),n=null;if(!m){w&&M();return}x=!1,TQ.stopPropagation(p),M(),l==BTN_TYPE.DELAY&&(W(o),o=null,o=window.setInterval(U,t),F(!1)),P(),SoundMgr.playSound(res_sounds.clickBtnUp)},M=function(){if(!j)return;if(l==BTN_TYPE.CHECK)return;$()},N=function(a){p=a?a:window.event,TQ.stopPropagation(p),j=!0;if(!m)return;P()},O=function(a){p=a?a:window.event,j=!1;if(!m)return;P()},P=function(){if(!m){Y("disable",r.cls.disable);return}l==BTN_TYPE.CHECK?Q():R()},Q=function(){var a=S("normal");i&&T()?a=S("pressblinking"):T()?a=S("blinking"):i&&j?a=S("presshot"):i?a=S("press"):j&&(a=S("hot")),Y(a.name,a.cls)},R=function(){var a=S("normal");T()?a=S("blinking"):x&&j?a=S("press"):j&&(a=S("hot")),Y(a.name,a.cls)},S=function(a){return r.cls[a]?{name:a,cls:r.cls[a]}:a=="blinking"?S("hot"):a=="presshot"?S("press"):a=="pressblinking"?S("press"):a=="hot"?S("normal"):a=="press"?S("normal"):S("normal")},T=function(){return y?y.isBlinkingFrame():!1},U=function(){W(o),o=null,F(!0)},V=function(){if(q<3){++q;return}$()},W=function(a){a&&(window.clearInterval(a),a=null)},X=function(){f=e;if(r.type>0){TQ.appendClass(e,"ui-back");var a=r.cls.normal;for(var b in a){var c=TQ.createDom("div");TQ.append(e,c)}}r.type==1||r.type==2?f=e.childNodes[1]:r.type==3&&(f=e.childNodes[4]),g=f,_()&&(f=TQ.createDom("div"),TQ.append(g,f),f.style.textAlign="center",f.style.whiteSpace="nowrap"),TQ.isIE()||TQ.appendClass(f,"black_edge")},Y=function(a,b){if(b.length==1)TQ.setClass(e,b[0]);else{var c=e.childNodes;for(var d=0;d<b.length;++d)TQ.setClass(c[d],b[d])}ab(),TQ.isIE()||TQ.appendClass(f,"black_edge"),Z(a)},Z=function(a){if(!A)return;if(!r.newFlag.offsets)return;var b=r.newFlag.offsets[a];b?TQ.setDomPos(z,B.x+b.x,B.y+b.y):TQ.setDomPos(z,B.x,B.y)},$=function(){for(var a=h.length-1;a>=0;--a){var b=h[a];b.caller.call(b.self,k,m_posEvent)}},_=function(){return!1},ab=function(){if(g==f)return;TQ.setDomSize(f,TQ.getDomWidth(g),TQ.getDomHeight(g))};this.init.apply(this,arguments)},BLINKING_TYPE={INSERT:0,FLOAT:1},BlinkingPanel=Class.extern(function(){var a=50,b=2,c,d,e,f,g,h,i,j,k,l,m,n,o,p={left:-1e3,top:-1e3},q={color:"#ffff00",borderw:b},r={x:0,y:0,w:0,h:0},s,t,u=b;this.init=function(a,b){c=a,d=this,s=!1,o=BLINKING_TYPE.FLOAT,b&&b.color&&(q.color=b.color),b&&b.borderw&&(q.borderw=b.borderw),b&&b.bakImgs&&(q.bakImgs=b.bakImgs),u=q.borderw,j=TQ.createDom("div"),TQ.setCSS(j,"zIndex",isNull(b.zIndex)?UI_ZORDER_TOOLTIP:b.zIndex),TQ.setCSS(j,"position","absolute"),TQ.setCSS(j,"left","0px"),TQ.setCSS(j,"top","0px"),TQ.setDomWidth(j,0),TQ.setDomHeight(j,0),b.bakImgs?z(b.bakImgs,1,1,1,1):x(1,1,1,1,1)},this.setCaller=function(a){t=a},this.bind=function(a,b,c,d,e,f,g){this.unbind(),h=a,i=b,o=BLINKING_TYPE.INSERT,c&&(o=c),k=0,d&&(k=d),l=0,e&&(l=e),m=f,f||(m=TQ.getDomWidth(j)),n=g,g||(n=TQ.getDomHeight(j)),TQ.append(h,j),o==BLINKING_TYPE.FLOAT?v():q.bakImgs?A(k,l,m,n):y(k,l,m,n,u),TQ.setCSS(j,"display","none"),s=!0},this.unbind=function(){this.stop(),s&&(TQ.remove(h,j),s=!1),p={left:-1e3,top:-1e3},r={x:0,y:0,w:0,h:0}},this.start=function(b){e||(e=window.setInterval(w,a)),f=b,f==-1&&(f=2147483647),g=0,TQ.setCSS(j,"display","block")},this.stop=function(){e&&(window.clearInterval(e),e=null),TQ.setCSS(j,"display","none")},this.getRect=function(){return r},this.isStart=function(){return e!=null};var v=function(){var a=TQ.domOffset(h),b=TQ.domOffset(i);b.left=b.left-a.left,b.top=b.top-a.top;if(p.top!=b.top||p.left!=b.left)q.bakImgs?A(b.left+k,b.top+l,m,n):y(b.left+k,b.top+l,m,n,u),p.top=b.top,p.left=b.left},w=function(){var b=0;g+=a+b;if(g>=f){d.stop(),TQ.setCSS(j,"opacity",0),t&&t.caller.call(t.self,0);return}o==BLINKING_TYPE.FLOAT&&v();var c=60+Math.floor(Math.cos(g*.008)*40);TQ.setCSS(j,"opacity",c)},x=function(a,b,c,d,e){for(var f=0;f<4;++f){var g=TQ.createDom("div");TQ.append(j,g),TQ.setCSS(g,"backgroundColor",q.color),TQ.setCSS(g,"position","absolute"),TQ.setCSS(g,"overflow","hidden"),TQ.setCSS(g,"zIndex",f+1)}y(a,b,c,d,e)},y=function(a,b,c,d,e){var f=TQ.domOffset(h);r.x=f.left+a,r.y=f.top+b,r.w=c,r.h=d,TQ.setCSS(j,"left",a+"px"),TQ.setCSS(j,"top",b+"px");var g=[{x:0,y:0,w:c,h:e},{x:0,y:d-e,w:c,h:e},{x:0,y:0,w:e,h:d},{x:c-e,y:0,w:e,h:d}];for(var i=0,k=g.length;i<k;++i){var l=g[i],m=j.childNodes[i];TQ.setCSS(m,"left",l.x+"px"),TQ.setCSS(m,"top",l.y+"px"),TQ.setDomWidth(m,l.w),TQ.setDomHeight(m,l.h)}TQ.getBrowserType()==BS_MSIE&&(TQ.setDomWidth(j,c),TQ.setDomHeight(j,d))},z=function(a,b,c,d,e){for(var f=0;f<a.length;++f){var g=a[f],h=TQ.createDom("div");TQ.append(j,h),TQ.setClass(h,g)}A(b,c,d,e)},A=function(a,b,c,d){var e=TQ.domOffset(h);r.x=e.left+a,r.y=e.top+b,r.w=c,r.h=d,TQ.setCSS(j,"left",a+"px"),TQ.setCSS(j,"top",b+"px");var f=8,g=8,i=c-2*f,k=d-2*g,l=[{x:0,y:0,w:c,h:d}];j.childNodes.length==8&&(l=[{x:0,y:0,w:f,h:g},{x:f,y:0,w:i,h:g},{x:f+i,y:0,w:f,h:g},{x:0,y:g,w:f,h:k},{x:f+i,y:g,w:f,h:k},{x:0,y:g+k,w:f,h:g},{x:f,y:g+k,w:i,h:g},{x:f+i,y:g+k,w:f,h:g}]);for(var m=0,n=l.length;m<n;++m){var o=l[m],p=j.childNodes[m];TQ.setDomRect(p,o.x,o.y,o.w,o.h)}if(TQ.isIE6()||TQ.isIE7()||TQ.isIE8())TQ.setDomWidth(j,c),TQ.setDomHeight(j,d)}}),BlinkingCtrl=Class.extern(function(){var a=250,b,c,d,e,f,g,h,i,j,k;this.init=function(a){b=a,c=this,h=!1},this.setCaller=function(a){i=a},this.bind=function(a,b){k=b,this.unbind(),g=a,h=!0},this.unbind=function(){this.stop(),g=null,h=!1},this.getBind=function(){return g},this.start=function(b){d||(d=window.setInterval(l,a)),e=b,e==-1&&(e=2147483647),f=0,j=!0},this.stop=function(){d&&(window.clearInterval(d),d=null),g&&TQ.setCSS(g,"opacity",100)},this.isStart=function(){return d!=null};var l=function(){var b=0;f+=a+b;if(f>=e){c.stop(),i&&i.caller.call(i.self,k);return}TQ.setCSS(g,"opacity",j?100:0),j=!j}})