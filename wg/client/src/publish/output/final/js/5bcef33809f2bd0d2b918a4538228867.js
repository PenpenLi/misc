Menu=function(){var a,b,c,d,e,f,g,h,i=!1;this.init=function(f,g){a=this,b=[],e=null,g.className||(g.className="menu_panel"),g.zindex||(g.zindex=UI_ZORDER_MENU),g.noadjustw&&(i=g.noadjustw),c=new PopPanel(f,g),d=List.snew(f,c.getDom()),d.setCols({sel:"",hot:"itemhot",normal:"itemnor",disable:"itemdis"},[{sel:"",hot:"coliconhot",normal:"coliconnor",disable:"coliconnor"},{sel:"",hot:"colnamehot",normal:"colnamenor",disable:"colnamedis"},{sel:"",hot:"coliconhot",normal:"coliconnor",disable:"coliconnor"}]),c.hide(),d.setCaller({self:this,caller:k},{self:this,caller:l},{self:this,caller:m}),h=90,g.width&&(h=g.width)},this.setClass=function(a,b){d.setCols(a,b)},this.addMenuItem=function(a){var c=d.getCount();d.setItemCount(c+1);var e=null;a.submenu&&(e="comm/submenu.gif"),d.setItem(c,[{icon:a.icon},{text:a.text},{icon:e}]);var f=d.getItem(c);return j(f),b.push({id:a.id,icon:a.icon,rightarrow:e,submenu:a.submenu,vitem:f,separator:a.separator?!0:!1}),f},this.setItemText=function(a,c){var e=s(a),f=b[e];d.setItem(e,[{icon:f.icon},{text:c},{icon:f.rightarrow}])},this.addSeparator=function(a){var b=this.addMenuItem({id:a.id,separator:!0,icon:null,text:""});return b.subs=[],TQ.setClass(b.item,"splititem"),b},this.show=function(a,b){var d={cx:c.getWidth(),cy:c.getHeight()},e=TQ.getAdjustPosByWinSize(a,d,b);c.show(e)},this.hide=function(){c.hide()},this.isShow=function(){return c.isShow()},this.setCaller=function(a,b,c){e=a,f=b,g=c},this.getRootList=function(){return d},this.showItem=function(a,b){o(a,b)},this.enableItem=function(a,b){p(a,b)},this.isEnable=function(a){return q(a)},this.getCount=function(){return d.getCount()},this.getItem=function(a){return b[a]},this.hideAllItem=function(){for(var a=0,b=d.getCount();a<b;++a){var c=d.getItem(a);TQ.setCSS(c.item,"display","none"),TQ.setCSS(c.item,"heigth","0px")}},this.setDisableCanClick=function(a){d.setDisableCanClick(a)},this.clear=function(){for(var a=0;a<b.length;++a){var c=b[a];c.vitem&&c.vitem.tipid!=undefined&&TTIP.delTip(c.vitem.tipid)}b=[],d.setItemCount(0)},this.click=function(a){k(null,a)};var j=function(a){if(a&&!i){TQ.setDomWidth(a.item,h);var b=h-TQ.getDomWidth(a.subs[0].item)-TQ.getDomWidth(a.subs[2].item);TQ.setDomWidth(a.subs[1].item,b-4)}},k=function(a,c){var d=b[c];e&&!d.separator&&!d.submenu&&e.caller.call(e.self,d.id)},l=function(a){var c=b[a];if(c.submenu){var d=TQ.domOffset(c.vitem.item);c.submenu.show({x:d.left+TQ.getDomWidth(c.vitem.item),y:d.top},{cx:TQ.getDomWidth(c.vitem.item),cy:TQ.getDomHeight(c.vitem.item)}),n([a])}else n([]);f&&f.caller.call(f.self,c.id)},m=function(a){var c=b[a];f&&g.caller.call(g.self,c.id)},n=function(a){for(var c=0;c<b.length;++c){if(TQ.find(a,null,c))continue;b[c].submenu&&b[c].submenu.hide()}},o=function(a,b){var c=r(a);c&&(TQ.setCSS(c.item,"display",b?"block":"none"),TQ.setCSS(c.item,"heigth","0px"))},p=function(a,b){var c=s(a);c>=0&&d.enableItem(c,b)},q=function(a){var b=s(a);return b>=0?d.isEnable(b):!1},r=function(a){var b=s(a);return b>=0?d.getItem(b):null},s=function(a){for(var c=0;c<d.getCount();++c){var e=b[c];if(e.id==a)return c}return-1};this.init.apply(this,arguments)}