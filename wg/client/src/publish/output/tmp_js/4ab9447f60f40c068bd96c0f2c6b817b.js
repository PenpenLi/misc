DirectionVector=Class.extern(function(){this.calcDirectionVector=function(a,b){var c=this.calcDistance(a,b),d=(b.x-a.x)/c,e=(b.y-a.y)/c;return{x:d,y:e}},this.getDirectionByVector=function(a){var b=0,c=0;return Math.abs(a.x)>=Math.abs(a.y)?(b=a.x,c=0):(b=0,c=a.y),b>0?1:c>0?2:b<0?3:c<0?4:0},this.calcDistance=function(a,b){return Math.sqrt((a.x-b.x)*(a.x-b.x)+(a.y-b.y)*(a.y-b.y))}}).snew(),MoveRoute=Class.extern(function(){var a=null,b=null,c={x:0,y:0},d=null,e=0,f=0,g=[];this.init=function(a,b,c){h(a,b,c),i(),this.update()},this.update=function(){if(this.isEnd())return;j()},this.getPosition=function(){return c},this.getDirection=function(){return e},this.isEnd=function(){var a=d[d.length-1];return a.x==c.x&&a.y==c.y};var h=function(e,g,h){a=e,b=g,c.x=h[0].x,c.y=h[0].y,d=h,f=a.getCurTimeMs()},i=function(){g=[];var a=0;g.push(a);for(var b=1;b<d.length;++b)a+=DirectionVector.calcDistance(d[b-1],d[b]),g.push(a)},j=function(){var h=(a.getCurTimeMs()-f)*b;h=Math.min(h,g[g.length-1]);var i=k(h),j=d[i-1],l=d[i],m=DirectionVector.calcDirectionVector(j,l),n=h-g[i-1];c.x=j.x+m.x*n,c.y=j.y+m.y*n,e=DirectionVector.getDirectionByVector(m)},k=function(a){for(var b=0;b<g.length;++b){var c=g[b];if(a<c)return b}return g.length-1}})