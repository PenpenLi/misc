var AUCTION_STEP=10;AlliAuctionBuyDlg=JBaseDlg.ex({_innerInit:function(){this.op_=null},_getDlgCfg:function(){return{modal:!1,title:rstr.alli.auctionbuydlg.auctionTitle,pos:{x:"center",y:40},uicfg:uicfg.alli.auctionbuydlg}},_setCallers:function(){TTIP.setCallerData(this.items_.tooltips.$item,{self:this,caller:this._onGetItemTip},{}),this.items_.buyBtn.setCaller({self:this,caller:this._onClickBuyBtn}),this.items_.cancelBtn.setCaller({self:this,caller:this._onCancelBtn})},_afterCreate:function(){this.items_.contribution.setLimitCaller({self:this,caller:this._onGetLimit})},_initInfo:function(){this.op_=AlliAuctionBuyBaseOp.createOp(this.params_.type,this.g_,this.dlg_,this.params_.item,this.items_),this.op_.setTitle(),this.op_.setBuyBtnText(),CommDrawItem.drawItemIcon(this.items_.icon,this.params_.item.itemres),TQ.setRichText(this.items_.desc,this.params_.item.itemres.desc),TQ.setRichText(this.items_.itemNumber,this.params_.item.num),this.items_.contribution.setVal(this._getMinPrice())},_onGetItemTip:function(){var a=SysItemMaker.make(0,this.params_.item.itemres);return TIPM.getItemDesc(a,"sys")},_onGetLimit:function(){return this.op_.getLimit()},_onClickBuyBtn:function(){var a=this.items_.contribution.getVal();if(a<this._getMinPrice()&&a<this.params_.item.fixed){this.g_.getGUI().sysMsgTips(SMT_WARNING,TQ.format(rstr.alli.auctionbuydlg.lbl.tooLowPrice,this._getMinPrice()));return}AllianceSender.sendAuctionBuyItem(this.g_,this.params_.item.id,a)},_onCancelBtn:function(){this.hideDlg()},_getMinPrice:function(){return this.params_.item.auction+AUCTION_STEP}}),AlliAuctionBuyBaseOp=JClass.ex({init:function(a,b,c,d){this.g_=a,this.dlg_=b,this.item_=c,this.items_=d},setTitle:function(){},setBuyBtnText:function(){},getLimit:function(){},createOp:function(a,b,c,d,e){return a=="auction"?AlliAuctionBuyAuctionOp.snew(b,c,d,e):AlliAuctionBuyFixedOp.snew(b,c,d,e)}}),AlliAuctionBuyAuctionOp=AlliAuctionBuyBaseOp.ex({setTitle:function(){this.dlg_.setTitle(rstr.alli.auctionbuydlg.auctionTitle)},setBuyBtnText:function(){this.items_.buyBtn.setText(rstr.alli.auctionbuydlg.btn.auction)},getLimit:function(){return{min:0,max:this.item_.fixed-1}}}),AlliAuctionBuyFixedOp=AlliAuctionBuyBaseOp.ex({setTitle:function(){this.dlg_.setTitle(rstr.alli.auctionbuydlg.fixedTitle)},setBuyBtnText:function(){this.items_.buyBtn.setText(rstr.alli.auctionbuydlg.btn.confirmFixed)},getLimit:function(){return{min:this.item_.fixed,max:this.item_.fixed}}})