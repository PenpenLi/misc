VirtualList=Class.extern(function(){}),VirtualTabCtrl=Class.extern(function(){this.setDrawCaller=function(a){}}),List=Class.extern(function(){var a=null,b=null,c=[],d=[],e=0,f=null,g=null,h=null,i=null,j=null,k=null,l=-1,m=null,n=null,o=null,p=!1,q=0,r=!1;this.init=function(c,d){a=c;if(d.tagName&&d.tagName.toLowerCase()=="div")b=d;else{if(d.uiClass()!="Scroller"){alert("parent invalid type");return}b=d.getContainerObj(),o=d}g={sel:"",hot:"",normal:"",disable:""},f=this},this.uiClass=function(){return"List"},this.setItemTmpl=function(a){g=a.itemclass,m=a},this.setItemTmplEx=function(a){g=a.c,n=a},this.cancelFirstClick=function(a){p=a},this.setCols=function(a,b){g=a,d=b},this.setCurSel=function(a){x(a),w(null,l)},this.getCurSel=function(){return l},this.setItemCount=function(a){s(a)},this.getCount=function(){return e},this.getItem=function(a){return a>=0&&a<c.length?c[a]:null},this.setCaller=function(a,b,c,d){h=a,i=b,j=c,k=d},this.setItem=function(a,b){var d=c[a].subs;for(var e=0;e<b.length;++e){var f=b[e];isNull(f.text)?isNull(f.icon)||IMG.setBKImage(d[e].item,IMG.makeImg(f.icon)):TQ.setHtml(d[e].item,f.text)}},this.enableItem=function(a,b){c[a].enable!=b&&(c[a].enable=b,v(a,b?"normal":"disable"))},this.isEnable=function(a){return c[a].enable},this.getSubItem=function(a,b){return a.exsubs[b]},this.scrollPos=function(a){o&&o.scrollPos(a)},this.refresh=function(){o&&(o.setScrollDomH(1e3),o.refresh())},this.getScroller=function(){return o},this.getParent=function(){return b},this.setDisableCanClick=function(a){r=a},this.clickItem=function(a,b){w(a,b)},this.dbclickItem=function(a,b){k&&k.caller.call(k.self,a,b)};var s=function(h){for(var i=c.length;i<h;++i){var j=TQ.createDom("div");TQ.append(b,j),TQ.setClass(j,g.normal),c.push({item:j,exsubs:{},subs:[],enable:!0});var k=c[c.length-1],l=k.subs,o=k.exsubs;if(m){j.innerHTML=m.xml;for(var r=0;r<j.childNodes.length;++r){var s=j.childNodes[r];q=0,y(i,j,s,l,!1)}}else if(n){a.getGUI().buildDomItems(j,n.cg,null,o);for(var r=0;r<j.childNodes.length;++r){var s=j.childNodes[r];q=0,y(i,j,s,null,!1)}p&&(g.hot!=""||g.sel!="")&&(TQ.setClass(j,""),TQ.setClass(j.firstChild,""),TQ.setClass(j.firstChild.firstChild,g.normal)),TQ.setCSS(j,"position","relative"),TQ.setCSS(j.firstChild,"position","absolute"),TQ.setCSS(j.firstChild,"left","0px"),TQ.setCSS(j.firstChild,"top","0px")}else for(var r=0;r<d.length;++r){var s=TQ.createDom("div");q=0,y(i,j,s,l,!0)}}for(var i=0;i<h;++i){var j=c[i].item;TQ.setCSS(j,"display","block")}for(var i=h;i<c.length;++i){var j=c[i].item;TQ.setCSS(j,"display","none")}e=h,f.refresh()},t=function(a){i&&i.caller.call(i.self,a);if(!c[a].enable)return;var b="sel";g["sel"]==""&&(b="hot"),v(a,l==a?b:"hot")},u=function(a){j&&j.caller.call(j.self,a);if(!c[a].enable)return;var b="sel";g["sel"]==""&&(b="normal"),v(a,l==a?b:"normal")},v=function(a,b){if(a>=0&&a<c.length){var e=c[a];if(p&&e.item.firstChild&&e.item.firstChild.firstChild&&g[b]!="")TQ.setClass(e.item.firstChild.firstChild,g[b]);else{TQ.setClass(e.item,g[b]);if(!m&&!n)for(var f=0;f<e.subs.length;++f)TQ.setClass(e.subs[f].item,d[f][b])}}},w=function(a,b){h&&h.caller.call(h.self,a,b)},x=function(a){v(l,"normal"),l=parseInt(a,10),l>=e&&(l=Math.max(0,e-1));var b="sel";g["sel"]==""&&(b="hot"),v(l,b)},y=function(a,e,g,h,i){if(!g.tagName)return;q++;var j=b.tagName.toLowerCase();if(j=="div"||j=="input"||j=="textarea"){i&&e.appendChild(g),h&&h.push({item:g,subs:[]}),g.setAttribute("itemidx",a),!m&&!n&&TQ.setClass(g,d[h.length-1].normal);if(z()){var o=function(a,b,d){var e=TQ.makeMouseEvent(b.pageX,b.pageY,BTN_LEFT,d);TQ.stopPropagation(e);var f=g.getAttribute("itemidx");if(!c[f].enable){r&&w(e,f);return}x(f),w(e,l)};isMobileBrowser()&&TQ.captureTouchEvent(g,{self:f,touchStart:o}),isPcBrowser()&&(TQ.addEvent(g,"dragstart",function(a){return!1}),TQ.addEvent(g,"mouseover",function(a){a||(a=window.event),t(parseInt(g.getAttribute("itemidx")))}),TQ.addEvent(g,"mouseout",function(a){a||(a=window.event),u(parseInt(g.getAttribute("itemidx")))}),TQ.addEvent(g,"click",function(a){a||(a=window.event),TQ.stopPropagation(a);var b=g.getAttribute("itemidx");if(!c[b].enable){r&&w(a,b);return}x(b),w(a,l)}),TQ.addEvent(g,"dblclick",function(a){a||(a=window.event),TQ.stopPropagation(a),k&&k.caller.call(k.self,a,l)}))}var p=null;h&&(p=h[h.length-1].subs);if(g.childNodes)for(var s=0;s<g.childNodes.length;++s)y(a,g,g.childNodes[s],p,i)}},z=function(){return!p||q>=2}}),Tree=function(){var a=null,b=null,c=null,d={},e=0,f=-1,g=null,h;this.initialize=function(d,e){a=d,b=this;var f=null;if(e.tagName&&e.tagName.toLowerCase()=="div")f=e;else{if(e.uiClass()!="Scroller"){alert("parent invalid type");return}f=e.getContainerObj(),h=e}c={parent:null,container:null,titledom:null,subdom:f,state:0,subs:[]},TQ.appendClass(c.subdom,"ui-tree")},this.uiClass=function(){return"Tree"},this.getRoot=function(){return c},this.getItemChildren=function(a){return a.subs},this.getItemFirstChild=function(a){return a.subs.length>0?a.subs[0]:null},this.setItemText=function(a,b){TQ.setHtml(a.titledom,b)},this.getItemText=function(a){return TQ.getTextEx(a.titledom)},this.append=function(a,c){var d=i(a,c);return b.refresh(),d},this.remove=function(a){if(a){a.keyid==f&&(f=-1);for(var c=a.subs.length-1;c>=0;--c){var e=a.subs[c];b.remove(e)}d[a.keyid]=null,TQ.find(a.parent.subs,"keyid",a.keyid)&&TQ.removeElement(a.parent.subs,TQ.getLastFindIdx()),TQ.remove(a.parent.subdom,a.container),TQ.deleteDom(a.container),a.container=null}},this.removeAll=function(){for(var a=c.subs.length-1;a>=0;--a){var d=c.subs[a];b.remove(d)}b.refresh()},this.getCurSel=function(){return f>=0?d[f]:null},this.setCurSel=function(a){j(null,a),k(a.parent),s(a)},this.setCaller=function(a){g=a},this.scrollPos=function(a){h&&h.scrollPos(a)},this.refresh=function(){h&&h.refresh()},this.getScroller=function(){return h};var i=function(a,b){var c=TQ.createDom("div"),f=TQ.createDom("div");TQ.append(c,f),TQ.setClass(f,"item-n"),TQ.setClass(c,"item-container"),TQ.setHtml(f,b.text),a.subdom||(a.subdom=TQ.createDom("div"),TQ.setClass(a.subdom,"item-sub"),TQ.append(a.container,a.subdom)),TQ.append(a.subdom,c),f.setAttribute("itemkey",e);var g=null;b.userdata&&(g=b.userdata);var h=0;b.state&&(h=b.state);var i={parent:a,container:c,keyid:e,titledom:f,subdom:null,state:h,userdata:g,subs:[]};return a.subs.push(i),d[e]=i,++e,e>2147483647&&(e=0),a.titledom&&(a.state==0?(TQ.removeClass(a.titledom,"item-expand item-collapse"),TQ.appendClass(a.titledom,"item-expand"),TQ.setCSS(a.subdom,"display","block")):a.state==1&&(TQ.removeClass(a.titledom,"item-expand item-collapse"),TQ.appendClass(a.titledom,"item-collapse"),TQ.setCSS(a.subdom,"display","none"))),TQ.addEvent(f,"dragstart",function(a){return!1}),TQ.addEvent(f,"mouseover",function(a){a=a?a:window.event,m(f.getAttribute("itemkey"))}),TQ.addEvent(f,"mouseout",function(a){a=a?a:window.event,n(f.getAttribute("itemkey"))}),TQ.addEvent(f,"click",function(a){a=a?a:window.event,TQ.stopPropagation(a);var b=f.getAttribute("itemkey"),c=d[b];j(a,c),p(a,b)}),i},j=function(a,b){var c=b&&b.subs.length==0;c&&(l(f),f=b.keyid,o(f,"item-p")),g!=null&&g.caller.call(g.self,a,b)},k=function(a){while(a)a.state==1&&r(a),a=a.parent},l=function(a){a>=0&&o(a,"item-n")},m=function(a){o(a,f==a?"item-p":"item-h")},n=function(a){o(a,f==a?"item-p":"item-n")},o=function(a,b){var c=d[a];c&&(TQ.removeClass(c.titledom,"item-h item-p item-n"),TQ.appendClass(c.titledom,b))},p=function(a,b){var c=d[b];c.state==0?q(c):c.state==1&&r(c)},q=function(a){a.subdom&&(TQ.setCSS(a.subdom,"display","none"),TQ.removeClass(a.titledom,"item-expand item-collapse"),TQ.appendClass(a.titledom,"item-collapse"),a.state=1,h&&h.refresh())},r=function(a){a.subdom&&(TQ.setCSS(a.subdom,"display","block"),TQ.removeClass(a.titledom,"item-expand item-collapse"),TQ.appendClass(a.titledom,"item-expand"),a.state=0,h&&h.refresh())},s=function(a){if(h&&a&&a.titledom){var b=a.titledom.offsetTop,d=b+TQ.getDomHeight(a.titledom),e=parseInt(c.subdom.style.top);e=-e;var f=h.getDom(),g=TQ.getDomHeight(f),i=e;b<e&&(i=b),d>e+g&&(i=d-g),h.scrollPos(i)}};this.initialize.apply(this,arguments)}