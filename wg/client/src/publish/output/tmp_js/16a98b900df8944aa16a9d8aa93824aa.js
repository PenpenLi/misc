ActBar=Class.extern(function(){var a=68,b=5;this.init=function(a,b){this.g_=a,this.actList_=b,this.actObjs_=[],this._regActObjs(),this._setItems(),this._setListWidth()},this.showChange=function(){this._setListWidth()},this._regActObjs=function(){this.actObjs_.push(ActOnlineTask.snew(this.g_,this)),this.actObjs_.push(ActYDTask.snew(this.g_,this)),this.actObjs_.push(ActBDTask.snew(this.g_,this)),this.actObjs_.push(Act3366Task.snew(this.g_,this)),this.actObjs_.push(ActFirstPayTask.snew(this.g_,this)),this.actObjs_.push(PayActTask.snew(this.g_,this))},this._setItems=function(){this.actList_.setItemCount(this.actObjs_.length);for(var a=0;a<this.actList_.getCount();++a){var b=this.actList_.getItem(a),c=this.actObjs_[a];c.set(b)}},this._setListWidth=function(){var c=this._getShowCnt(),d=c*a+b;TQ.setDomWidth(this.actList_.getParent(),d)},this._getShowCnt=function(){var a=0;for(var b=0;b<this.actObjs_.length;++b){var c=this.actObjs_[b];c.isShow()&&a++}return a}}),ActBarBaseTask=Class.extern(function(){this.set=function(a){this.item_=a,this.item_.exsubs.btn.setCaller({self:this,caller:this._onClickGet}),TTIP.setCallerData(this.item_.exsubs.tooltips.$item,{self:this,caller:this._onGetTooltip},{}),TQ.fixIE6Png(this.item_.label_bak),this._update()}}),ActOnlineTask=ActBarBaseTask.extern(function(){this.g_=null,this.item_=null,this.isShow_=!0,this.observer_=null,this.lastState_=-1,this.init=function(a,b){this.g_=a,this.observer_=b,this.g_.regUpdater(this,this._onUpdate,1e3),this.g_.regEvent(EVT.NET,NETCMD.TASK,this,this._onSvrTask),this.g_.regEvent(EVT.LOGIN_OK,0,this,this._onLoginOk)},this.isShow=function(){return this.isShow_},this._update=function(){var a=this.g_.getImgr().getOnlineTask(),b=a.id>0;TQ.setCSS(this.item_.item,"display",b?"block":"none"),b!=this.isShow_&&(this.isShow_=b,this.observer_.showChange());if(!this.isShow_)return;var c=0,d=a.stopTime-this.g_.getSvrTimeS();d>0?(TQ.setTextEx(this.item_.exsubs.label,TQ.format(rstr.task.onlineTask.leftTime,TQ.formatTime(0,d))),IMG.setBKImage(this.item_.exsubs.icon,IMG.makeImg("actbar/onlinetask/commicon.png")),this.item_.exsubs.btn.enable(!1),c=0):(TQ.setTextEx(this.item_.exsubs.label,rstr.task.onlineTask.canGet),IMG.setBKImage(this.item_.exsubs.icon,IMG.makeImg("actbar/onlinetask/openicon.png")),this.item_.exsubs.btn.enable(!0),c=1),this.lastState_!=c&&(this.lastState_=c,TQ.fixIE6Png(this.item_.exsubs.icon))},this._onUpdate=function(){this._update()},this._onClickGet=function(){TaskSender.sendGetOnlineTaskReward(this.g_)},this._onSvrTask=function(a){a.data.onlinetask&&(TQ.dictCopy(this.g_.getImgr().getOnlineTask(),a.data.onlinetask),this._update())},this._onLoginOk=function(){TaskSender.sendGetOnlineTaskInfo(this.g_)},this._onGetTooltip=function(a){return rstr.task.onlineTask.tip}}),ActYDTask=ActBarBaseTask.extern(function(){this.isShow=function(){return g_platform=="qzone"},this._update=function(){this.isShow()?(TQ.setCSS(this.item_.exsubs.label_bak,"display","none"),IMG.setBKImage(this.item_.exsubs.icon,IMG.makeImg("actbar/yd/bk.png")),TQ.fixIE6Png(this.item_.exsubs.icon)):TQ.setCSS(this.item_.item,"display","none")},this._onClickGet=function(){UIM.openDlg("yellowdiamond")},this._onGetTooltip=function(a){return rstr.yellowdiamondDlg.tip.seeyd}}),ActBDTask=ActBarBaseTask.extern(function(){this.init=function(a){this.g_=a,this.g_.regEvent(EVT.ROLEBASE,4,this,this._onDiamondInfo)},this.isShow=function(){return g_platform=="3366"},this._update=function(){this.isShow()?(TQ.setCSS(this.item_.exsubs.label_bak,"display","none"),this._hasGift()?IMG.setBKImage(this.item_.exsubs.icon,IMG.makeImg("actbar/bd/bk.png")):IMG.setBKImage(this.item_.exsubs.icon,IMG.makeImg("actbar/bd/bk_open.png")),TQ.fixIE6Png(this.item_.exsubs.icon)):TQ.setCSS(this.item_.item,"display","none")},this._onClickGet=function(){UIM.openDlg("bluediamond")},this._onGetTooltip=function(a){return rstr.bluediamondDlg.tip.seebd},this._hasGift=function(){var a=this.g_.getImgr().getRoleRes().bdInfo;return this._getXDLevel(a)==0?!0:this._hasHighGift(a)||this._hasNewGift(a)||this._hasCommGift(a)||this._hasYearGift(a)||this._hasLvlGift(a)},this._onDiamondInfo=function(){this._update()},this._hasHighGift=function(a){return!TQ.isSameDay(a.got_highgift,this.g_.getSvrTimeS())},this._hasNewGift=function(a){return a.got_newgift?!1:!0},this._hasCommGift=function(a){return!TQ.isSameDay(a.got_commgift,this.g_.getSvrTimeS())},this._hasYearGift=function(a){return!TQ.isSameDay(a.got_yeargift,this.g_.getSvrTimeS())},this._hasLvlGift=function(a){var b=this.g_.getImgr().getRoleRes().level,c=this._getXDLevel(a);for(var d=0;d<res_bd_lvlgifts.length;++d){var e=res_bd_lvlgifts[d];if(e.level>b)continue;if(e.bdlvl>c)continue;if(!a.got_lvlgifts)continue;if(TQ.find(a.got_lvlgifts,null,e.id)==null)return!0}return!a.got_lvlgifts||a.got_lvlgifts.length==0},this._getXDLevel=function(a){return a.blue_vip_level?a.blue_vip_level:0}}),Act3366Task=ActBarBaseTask.extern(function(){this.init=function(a){this.g_=a},this.isShow=function(){return g_platform=="3366"},this._update=function(){this.isShow()?(TQ.setCSS(this.item_.exsubs.label_bak,"display","none"),IMG.setBKImage(this.item_.exsubs.icon,IMG.makeImg("actbar/3366/bk.png")),TQ.fixIE6Png(this.item_.exsubs.icon)):TQ.setCSS(this.item_.item,"display","none")},this._onClickGet=function(){UIM.openDlg("blue3366diamond")},this._onGetTooltip=function(a){return TQ.format(rstr.bluediamondDlg.tip.see3366,this.g_.getImgr().get3366GrowLevel())}}),ActFirstPayTask=ActBarBaseTask.extern(function(){this.isShow_=!0,this.g_=null,this.init=function(a,b){this.g_=a,this.observer_=b,this.g_.regEvent(EVT.TASKCHANGE,0,this,this._onTaskChange),this.isShow_=!0},this.isShow=function(){return this.isShow_},this._update=function(){var a=!this._firstPayTaskFinished();this.isShow_!=a&&(this.isShow_=a,this.observer_.showChange()),TQ.setCSS(this.item_.item,"display",this.isShow_?"block":"none");if(!this.isShow_)return;TQ.setCSS(this.item_.exsubs.label_bak,"display","none"),IMG.setBKImage(this.item_.exsubs.icon,IMG.makeImg("actbar/firstpay/bk.png")),TQ.fixIE6Png(this.item_.exsubs.icon)},this._onClickGet=function(){var a=TQ.find(this.g_.getImgr().getTask().actives,"id",FIXID.FIRST_PAYGOLD);UIM.getDlg("task").openDlg(),UIM.getDlg("task").selectTask("activity",TQ.getLastFindIdx())},this._onGetTooltip=function(a){return rstr.buyGoldDlg.tip.firstpay_libao},this._onTaskChange=function(){this._update()},this._firstPayTaskFinished=function(){var a=TQ.find(this.g_.getImgr().getTask().actives,"id",FIXID.FIRST_PAYGOLD);return a?a.state==TASK_STATE.COMPLETE:!0}}),PayActTask=ActBarBaseTask.extern(function(){this.isShow_=!0,this.g_=null,this.init=function(a,b){this.g_=a,this.observer_=b,this.g_.regEvent(EVT.PAYACT,0,this,this._onPayAct),this.isShow_=!0},this.isShow=function(){return this.isShow_},this._update=function(){var a=this._isInActTime();this.isShow_!=a&&(this.isShow_=a,this.observer_.showChange()),TQ.setCSS(this.item_.item,"display",this.isShow_?"block":"none");if(!this.isShow_)return;TQ.setCSS(this.item_.exsubs.label_bak,"display","none"),IMG.setBKImage(this.item_.exsubs.icon,IMG.makeImg("actbar/payact/bk.png")),TQ.fixIE6Png(this.item_.exsubs.icon)},this._onClickGet=function(){UIM.openDlg("payact")},this._onGetTooltip=function(a){return rstr.payActDlg.tip.payact_libao},this._onPayAct=function(){this._update()},this._isInActTime=function(){return this.g_.getImgr().getPayAct().payActTime.start>0}})