NpcDlg=JBaseDlg.ex({_getDlgCfg:function(){return{modal:!0,pos:{x:"center",y:"vcenter"},uiback:uiback.dlg.noborder,uicfg:uicfg.npcdlg}},_afterCreate:function(){this.bak_=this.g_.getGUI().createPanelUIBack(this.items_.conbk,uiback.dlg.npc,!1)},_setCallers:function(){this.items_.opslist.setCaller({self:this,caller:this._onSelectOption})},_initInfo:function(){this._initDesc(),this._initOpsList(),this._resetDescHeight(),this._resetOpsBarPosition(),this._resetBakSize()},_initDesc:function(){TQ.setRichText(this.items_.desc,this.params_.desc)},_initOpsList:function(){if(!this.params_.ops){this.items_.opslist.setItemCount(0);return}this.items_.opslist.setItemCount(this.params_.ops.length);for(var a=0;a<this.items_.opslist.getCount();++a){var b=this.items_.opslist.getItem(a);TQ.setRichText(b.exsubs.name,this.params_.ops[a])}},_resetDescHeight:function(){TQ.setCSS(this.items_.desc,"height","auto")},_resetOpsBarPosition:function(){var a=10,b=TQ.getDomPos(this.items_.desc).y,c=b+this.items_.desc.offsetHeight+a;TQ.setCSS(this.items_.opslist.getParent(),"top",c+"px"),TQ.setCSS(this.items_.opslist.getParent(),"height",this._getOpsBarHeight()+"px")},_resetBakSize:function(){var a=40,b=TQ.getDomPos(this.items_.opslist.getParent()).y,c=b+this._getOpsBarHeight()+a;TQ.setCSS(this.items_.conbk,"height",c+"px");var d=TQ.getDomSize(this.items_.conbk);this.g_.getGUI().setUIBack(this.bak_,d.cx,d.cy,uiback.dlg.npc.type)},_getOpsBarHeight:function(){var a=this.items_.opslist.getCount();return Math.floor((a+2)/3)*50},_onSelectOption:function(a,b){this.params_.caller&&this.params_.caller.invoke(b),this.hideDlg()}})