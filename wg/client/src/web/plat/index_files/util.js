$app.util={getACSRFToken:function(){var b=$app.util.cookie("lskey")||$app.util.cookie("skey");if(b==null){b=""}var d=5381;for(var c=0,a=b.length;c<a;++c){d+=(d<<5)+b.charAt(c).charCodeAt()}return d&2147483647},getURLParam:function(a){var i="";var e=window.location.href;var j=false;var f=a+"=";var c=f.length;if(e.indexOf("?")>-1){var g=e.substr(e.indexOf("?")+1);var d=g.split("&");for(var b=0;b<d.length;b++){if(d[b].substr(0,c)==f){var h=d[b].split("=");i=h[1];if(i.indexOf("#")>-1){var h=i.split("#");i=h[0]}j=true;break}}}if(j==false){return null}return i},trim:function(a){return a.replace(/^\s*(.*?)\s*$/,"$1")},cookie:function(b,j,m){if(typeof j!="undefined"){m=m||{};if(j===null){j="";m.expires=-1}var e="";if(m.expires&&(typeof m.expires=="number"||m.expires.toUTCString)){var f;if(typeof m.expires=="number"){f=new Date();f.setTime(f.getTime()+(m.expires*1000))}else{f=m.expires}e="; expires="+f.toUTCString()}var l=m.path?"; path="+m.path:"";var g=m.domain?"; domain="+m.domain:"";var a=m.secure?"; secure":"";document.cookie=[b,"=",encodeURIComponent(j),e,l,g,a].join("")}else{var d=null;if(document.cookie&&document.cookie!=""){var k=document.cookie.split(";");for(var h=0;h<k.length;h++){var c=$app.util.trim(k[h]);if(c.substring(0,b.length+1)==(b+"=")){d=decodeURIComponent(c.substring(b.length+1));break}}}return d}},copyToClipboard:function(b){if(window.clipboardData){window.clipboardData.setData("Text",b);return""}else{if(navigator.userAgent.indexOf("Opera")!=-1){alert("你的浏览器不支持复制，请用IE或者Firefox来完成复制!");return""}else{if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(g){alert("被浏览器拒绝！\n请在浏览器地址栏输入'about:config'并回车\n然后将'signed.applets.codebase_principal_support'设置为'true'")}var d=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!d){return""}var c=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!c){return""}c.addDataFlavor("text/unicode");var h=new Object();var a=new Object();var h=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);var i=b;h.data=i;c.setTransferData("text/unicode",h,i.length*2);var f=Components.interfaces.nsIClipboard;if(!d){return""}d.setData(c,null,f.kGlobalClipboard);return""}else{alert("你的浏览器不支持复制，请用IE或者Firefox来完成复制!")}}}},favorite:function(b,a){if(typeof b=="undefined"){b=window.location.href}if(typeof a=="undefined"){a=window.title}try{window.external.addFavorite(b,a)}catch(c){try{window.sidebar.addPanel(a,b,"")}catch(c){alert("加入收藏失败，请使用Ctrl+D进行添加")}}},clickMonitor:function(c){var b=new Image();var a=appConfig.tamsid;b.src="http://t.l.qq.com/ping?t=m&cpid="+a+"&url=http%3A//app_minisite_click_monitor/button"+a+c+"&ref"},log:function(a){if($app.B.name=="msie"){return}else{console.log(a)}},_createNode:function(b,c){var a,d=document.createElement(b);for(a in c){if(c.hasOwnProperty(a)){d.setAttribute(a,c[a])}}return d},track:function(){var a="http://t.l.qq.com/ping?t=m&cpid="+appConfig.tamsid+"&url="+escape(window.location.href)+"&ref="+escape(document.referrer);var b=new Image();b.src=a},toolbar:function(a,b){if("undefined"==typeof(a)){var a="2.4"}if("undefined"==typeof(b)&&"undefined"!=typeof(toolbarOpts)){var b=toolbarOpts}if("2.4"==a&&"undefined"==typeof(b)){loader("ajax/ajax",function(){$app.ajax.getJSONP("http://toolbar.tae.qq.com/2.4/jsonp.php?tamsid="+appConfig.tamsid,function(c){$app.util.initToolbar("2.4",c)})})}else{$app.util.initToolbar(a,b)}},initToolbar:function(a,c){if("undefined"!=typeof(c)){if("undefined"==appConfig){window.appConfig={}}for(var d in c){if("undefined"==typeof(appConfig[d])){appConfig[d]=c[d]}}}$app.css("http://toolbar.tae.qq.com/"+a+"/css/default.css");var b="http://toolbar.tae.qq.com/";b+="?v="+a;b+="&f=jslib.1.4";b+="&a="+appConfig.appid;b+="&t="+appConfig.tamsid;b+="&r="+appConfig.domain;b+="&s="+(appConfig.text?appConfig.text:"text");b+="&i="+appConfig.inviteUrl;var e=this._createNode("script",{src:b,type:"text/javascript",charset:"utf-8"});document.body.appendChild(e)}};var Act={};Act.ept={isLogin:function(){return $app.auth.isLogin()},login:function(a){$app.auth.login(a)},logout:function(a){$app.auth.logout(a)},getQQNum:function(){return $app.auth.getQQNum()},getACSRFToken:function(){return $app.util.getACSRFToken()},getJSONP:function(a,b){loader("ajax/ajax",function(){$app.ajax.getJSONP(a,b)})},getScript:function(){loader("ajax/ajax",function(){$app.ajax.getScript(url,callback)})},getQQAvatar:function(d,c,b,a){loader("utils/avatar",function(){$app.avatar.qq(d,c,b,a)})},getCss:function(a){$app.css(a)}};